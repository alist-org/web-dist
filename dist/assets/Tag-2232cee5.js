import{b as R,d as H,B as n,al as F,q as I,x as e,av as f,Q as s,S as p,ao as N,dr as E,ds as P,dt as b,W as m,du as S,dv as W,dw as c,cP as q,d4 as z,bt as w,n as y,R as J,M as K,I as Q,J as V,K as X,O as j,ai as G,dx as U,bs as C,dy as Y}from"./index-2768a655.js";import{g as Z,A as ee}from"./AddLabelDialog-8fa5be5f.js";import{D as te}from"./DeletePopover-b744f292.js";const se=()=>{const a=R(),{to:$}=H(),[L,u]=n(!1),[_,d]=n(!1),[k,i]=n(null),[g,M]=n(!1),[T,o]=n(!1),O=async()=>{var t;try{const r=await C.get("/fs/list");return r.code===500&&((t=r.message)!=null&&t.includes("please add a storage first"))?(o(!0),!1):!0}catch(r){return console.error("Failed to check storage:",r),!1}},[v,{refetch:x}]=F(async()=>g()?await U():{data:{content:[],total:0}}),A=async t=>await C.post(`/admin/label/delete?id=${t}`),l=async()=>{try{u(!0);const t=await O();M(t),t&&await x()}catch{y.error(a("global.refresh_failed"))}finally{u(!1)}};I(()=>{l()});const B=(t,r,h)=>{l()},D=async t=>{const r=await Y(t);w(r,h=>{i(h),d(!0)})};return e(G,{spacing:"$2",alignItems:"start",w:"$full",get children(){return[e(f,{spacing:"$2",get children(){return[e(s,{colorScheme:"accent",get loading(){return L()},onClick:l,get children(){return a("global.refresh")}}),e(p,{get when(){return g()},get children(){return e(s,{onClick:()=>{i(null),d(!0)},get children(){return a("global.add")}})}})]}}),e(p,{get when(){return g()},get children(){return e(N,{w:"$full",overflowX:"auto",get children(){return e(E,{highlightOnHover:!0,dense:!0,get children(){return[e(P,{get children(){return e(b,{get children(){return[e(m,{each:["name","description","create_time"],children:t=>e(S,{get children(){return a(`home.tag.${t}`)}})}),e(S,{get children(){return a("global.operations")}})]}})}}),e(W,{get children(){return e(m,{get each(){var t,r;return((r=(t=v())==null?void 0:t.data)==null?void 0:r.content)||[]},children:t=>e(b,{get children(){return[e(c,{get children(){return e(q,{get bgColor(){return Z(t.bg_color)},get color(){return t.bg_color},textTransform:"none",px:"$3",py:"$2",rounded:"$md",fontSize:"$sm",get children(){return t.name}})}}),e(c,{get children(){return t.description}}),e(c,{get children(){return z(t.create_time)}}),e(c,{get children(){return e(f,{spacing:"$2",get children(){return[e(s,{colorScheme:"accent",onClick:()=>D(t.id),get children(){return a("global.edit")}}),e(te,{get name(){return t.name},loading:!1,onClick:async()=>{const r=await A(t.id);w(r,()=>{y.success(a("global.delete_success")),l()})}})]}})}})]}})})}})]}})}})}}),e(ee,{get isOpen(){return _()},onClose:()=>{d(!1),i(null)},onSubmit:B,get editingLabel(){return k()}}),e(J,{get opened(){return T()},onClose:()=>o(!1),get children(){return[e(K,{}),e(Q,{get children(){return[e(V,{}),e(X,{get children(){return a("storages.no_storage_content")}}),e(j,{get children(){return[e(s,{colorScheme:"accent",onClick:()=>o(!1),get children(){return a("global.cancel")}}),e(s,{onClick:()=>{o(!1),$("/@manage/storages")},ml:"$2",get children(){return a("home.go_to_storages")}})]}})]}})]}})]}})};export{se as default};
