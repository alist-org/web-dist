System.register(["./index-legacy.87e1c49a.js","./Paginator-legacy.e29c2a43.js"],(function(e){"use strict";var r,t,n,a,c,l,i,s,d,o,g,u,h,$,y,k,p,f,w,m,C,b,S;return{setters:[e=>{r=e.a,t=e.aW,n=e.b9,a=e.m,c=e.h,l=e.d1,i=e.X,s=e.a4,d=e.bP,o=e.b5,g=e.S,u=e.cm,h=e.cn,$=e.C,y=e.ba,k=e.n,p=e.ck,f=e.G,w=e.e,m=e.k,C=e.ae,b=e.E},e=>{S=e.P}],execute:function(){var R=function(e){return e[e.Pending=0]="Pending",e[e.Running=1]="Running",e[e.Succeeded=2]="Succeeded",e[e.Canceling=3]="Canceling",e[e.Canceled=4]="Canceled",e[e.Errored=5]="Errored",e[e.Failing=6]="Failing",e[e.Failed=7]="Failed",e[e.WaitingRetry=8]="WaitingRetry",e[e.BeforeRetry=9]="BeforeRetry",e}(R||{});const x={[R.Failed]:"danger",[R.Succeeded]:"success",[R.Canceled]:"neutral"},v=e=>{const t=r();return c(p,{get colorScheme(){return x[e.state]??"info"},get children(){return t(`tasks.state.${e.state}`)}})},F=e=>{const p=r(),f="undone"===e.done?"cancel":"delete",w="done"===e.done&&e.state===R.Failed,[m,C]=t((()=>n.post(`/admin/task/${e.type}/${f}?tid=${e.id}`))),[b,S]=t((()=>n.post(`/admin/task/${e.type}/retry?tid=${e.id}`))),[x,F]=a(!1);return c(g,{get when(){return!x()},get children(){return c(l,{get bgColor(){return i("$background","$neutral3")()},w:"$full",overflowX:"auto",shadow:"$md",rounded:"$lg",p:"$2",direction:{"@initial":"column","@xl":"row"},spacing:"$2",get children(){return[c(s,{w:"$full",alignItems:"start",spacing:"$1",get children(){return[c(d,{size:"sm",css:{wordBreak:"break-all"},get children(){return e.name}}),c(v,{get state(){return e.state}}),c(o,{css:{wordBreak:"break-all"},get children(){return e.status}}),c(g,{get when(){return e.error},get children(){return c(o,{color:"$danger9",css:{wordBreak:"break-all"},get children(){return e.error}})}}),c(u,{w:"$full",trackColor:"$info3",rounded:"$full",size:"sm",get value(){return e.progress},get children(){return c(h,{color:"$info8",rounded:"$md"})}})]}}),c(l,{direction:{"@initial":"row","@xl":"column"},justifyContent:{"@xl":"center"},spacing:"$1",get children(){return[c(g,{get when(){return e.canRetry},get children(){return c($,{disabled:!w,display:w?"block":"none",get loading(){return b()},onClick:async()=>{const e=await S();y(e,(()=>{k.info(p("tasks.retry")),F(!0)}))},get children(){return p("tasks.retry")}})}}),c($,{colorScheme:"danger",get loading(){return m()},onClick:async()=>{const e=await C();y(e,(()=>{k.success(p("global.delete_success")),F(!0)}))},get children(){return p(`global.${f}`)}})]}})]}})}})},P=e=>{const l=r(),[i,o]=t((()=>n.get(`/admin/task/${e.type}/${e.done}`))),[u,h]=a([]),k=async()=>{const e=await o();y(e,(e=>h(e?.sort(((e,r)=>e.id>r.id?1:-1))??[])))};if(k(),"undone"===e.done){const e=setInterval(k,2e3);w((()=>clearInterval(e)))}const[p,R]=t((()=>n.post(`/admin/task/${e.type}/clear_done`))),[x,v]=t((()=>n.post(`/admin/task/${e.type}/clear_succeeded`))),[P,_]=t((()=>n.post(`/admin/task/${e.type}/retry_failed`))),[z,B]=a(1),I=m((()=>{const e=20*(z()-1),r=e+20;return u().slice(e,r)}));return c(s,{w:"$full",alignItems:"start",spacing:"$2",get children(){return[c(d,{size:"lg",get children(){return l(`tasks.${e.done}`)}}),c(g,{get when(){return"done"===e.done},get children(){return c(C,{gap:"$2",flexWrap:"wrap",get children(){return[c($,{colorScheme:"accent",get loading(){return i()},onClick:k,get children(){return l("global.refresh")}}),c($,{get loading(){return P()},onClick:async()=>{const e=await _();y(e,(()=>k()))},get children(){return l("tasks.retry_failed")}}),c($,{colorScheme:"danger",get loading(){return p()},onClick:async()=>{const e=await R();y(e,(()=>k()))},get children(){return l("global.clear")}}),c($,{colorScheme:"success",get loading(){return x()},onClick:async()=>{const e=await v();y(e,(()=>k()))},get children(){return l("tasks.clear_succeeded")}})]}})}}),c(s,{w:"$full",spacing:"$2",get children(){return c(f,{get each(){return I()},children:r=>c(F,b(r,e))})}}),c(S,{get total(){return u().length},defaultPageSize:20,onChange:e=>{B(e)}})]}})};e("T",(e=>{const t=r();return c(s,{w:"$full",alignItems:"start",spacing:"$4",get children(){return[c(d,{size:"xl",get children(){return t(`tasks.${e.type}`)}}),c(s,{w:"$full",spacing:"$2",get children(){return c(f,{each:["undone","done"],children:r=>c(P,{get type(){return e.type},done:r,get canRetry(){return e.canRetry}})})}})]}})}))}}}));
