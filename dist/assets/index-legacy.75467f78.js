System.register(["./index-legacy.87e1c49a.js","./useTitle-legacy.1462b19e.js","./webauthn-json.browser-ponyfill-legacy.8ddd819a.js"],(function(e){"use strict";var t,r,n,o,i,a,l,s,c,u,d,g,p,h,f,m,w,b,C,v,x,y,_,k,$,I,S,G,j,z,U,E,R,P,T,D,M,J,K,L,X,Z,N,O,Q,W,q;return{setters:[e=>{t=e.c8,r=e.E,n=e.c9,o=e.ca,i=e.ai,a=e.X,l=e.h,s=e.a7,c=e.aJ,u=e.U,d=e.b,g=e.c4,p=e.cb,h=e.e,f=e.ax,m=e.b9,w=e.bX,b=e.cc,C=e.cd,v=e.ce,x=e.cf,y=e.a,_=e.k,k=e.m,$=e.cg,I=e.aW,S=e.a4,G=e.bQ,j=e.au,z=e.bP,U=e.S,E=e.I,R=e.ch,P=e.b5,T=e.ae,D=e.C,M=e.bk,J=e.bl,K=e.ci,L=e.aC,X=e.bG,Z=e.n,N=e.ba},e=>{O=e.a},e=>{Q=e.s,W=e.g,q=e.a}],execute:function(){var A=i('<svg version=1.1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink height=896 width=967.8852157128662><defs><path id=path-2 opacity=1 fill-rule=evenodd d="M896,448 C1142.6325445712241,465.5747656464056 695.2579309733121,896 448,896 C200.74206902668806,896 5.684341886080802e-14,695.2579309733121 0,448.0000000000001 C0,200.74206902668806 200.74206902668791,5.684341886080802e-14 447.99999999999994,0 C695.2579309733121,0 475,418 896,448Z"></path><linearGradient id=linearGradient-3 x1=0.5 y1=0 x2=0.5 y2=1><stop offset=0 stop-opacity=1></stop><stop offset=1 stop-opacity=1></stop></linearGradient></defs><g opacity=1><use xlink:href=#path-2 fill=url(#linearGradient-3) fill-opacity=1>');const B=e=>{const t=r({startColor:"#28aff0",endColor:"#120fc4"},e);return i=A(),a=i.firstChild.firstChild.nextSibling.firstChild,l=a.nextSibling,n((e=>{var r=t.startColor,n=t.endColor;return r!==e.e&&o(a,"stop-color",e.e=r),n!==e.t&&o(l,"stop-color",e.t=n),e}),{e:void 0,t:void 0}),i;var i,a,l};var F=i('<svg height=1337 width=1337><defs><path id=path-1 opacity=1 fill-rule=evenodd d="M1337,668.5 C1337,1037.455193874239 1037.455193874239,1337 668.5,1337 C523.6725684305388,1337 337,1236 370.50000000000006,1094 C434.03835568300906,824.6732385973953 6.906089672974592e-14,892.6277623047779 0,668.5000000000001 C0,299.5448061257611 299.5448061257609,1.1368683772161603e-13 668.4999999999999,0 C1037.455193874239,0 1337,299.544806125761 1337,668.5Z"></path><linearGradient id=linearGradient-2 x1=0.79 y1=0.62 x2=0.21 y2=0.86><stop offset=0 stop-opacity=1></stop><stop offset=1 stop-opacity=1></stop></linearGradient></defs><g opacity=1><use xlink:href=#path-1 fill=url(#linearGradient-2) fill-opacity=1>');const H=e=>{const t=r({startColor:"#28aff0",endColor:"#120fc4"},e);return i=F(),a=i.firstChild.firstChild.nextSibling.firstChild,l=a.nextSibling,n((e=>{var r=t.startColor,n=t.endColor;return r!==e.e&&o(a,"stop-color",e.e=r),n!==e.t&&o(l,"stop-color",e.t=n),e}),{e:void 0,t:void 0}),i;var i,a,l},V=()=>{const e=a("#a9c6ff","#062b74");return l(s,{get bgColor(){return e()},pos:"fixed",top:"0",left:"0",overflow:"hidden",zIndex:"-1",w:"100vw",h:"100vh",get children(){return[l(s,{pos:"absolute",right:{"@initial":"-100px","@sm":"-300px"},top:{"@initial":"-1170px","@sm":"-900px"},get children(){return l(H,{})}}),l(s,{pos:"absolute",left:{"@initial":"-100px","@sm":"-200px"},bottom:{"@initial":"-760px","@sm":"-400px"},get children(){return l(B,{})}})]}})},Y=()=>{const e=c("sso_login_enabled"),t=u("sso_login_platform"),r=c("sso_compatibility_mode"),{searchParams:n,to:o}=d(),i=n.token;function a(e){const t=e.data;t.token&&(g(t.token),o(decodeURIComponent(n.redirect||p||"/"),!0))}if(null!=i&&""!=i&&(g(i),o(decodeURIComponent(n.redirect||p||"/"),!0)),window.addEventListener("message",a),h((()=>{window.removeEventListener("message",a)})),e){const e=()=>{const e=m.getUri()+"/auth/sso?method=sso_get_token";r?window.location.href=e:window.open(e,"authPopup","width=500,height=600")};let n;switch(t){case"Github":n=x;break;case"Microsoft":n=v;break;case"Google":n=C;break;case"Dingtalk":n=b;break;default:n=w}return l(f,{cursor:"pointer",boxSize:"$8",as:n,p:"$0_5",onclick:e})}};e("default",(()=>{const e=u("logo").split("\n"),r=a(e[0],e.pop()),n=y(),o=_((()=>`${n("login.login_to")} ${u("site_title")}`));O(o);const i=a("white","$neutral1"),[s,h]=k(localStorage.getItem("username")||""),[w,b]=k(localStorage.getItem("password")||""),[C,v]=k(""),[x,A]=k(!1),[B,F]=$("remember-pwd","false"),[H,ee]=k(!1),[te,re]=I((async()=>{return H()?m.post("/auth/login/ldap",{username:s(),password:w(),otp_code:C()}):m.post("/auth/login/hash",{username:s(),password:(e=w(),t(`${e}-https://github.com/alist-org/alist`)),otp_code:C()});var e})),[,ne]=I(((e,t,r)=>m.post("/authn/webauthn_finish_login?username="+r,JSON.stringify(t),{headers:{session:e}}))),[,oe]=I((e=>m.get("/authn/webauthn_begin_login?username="+e))),{searchParams:ie,to:ae}=d(),le=c("webauthn_login_enabled"),se=async()=>{A(!x())},ce=async()=>{if(x()){if(!Q())return void Z.error(n("users.webauthn_not_supported"));g(),"true"===B()?localStorage.setItem("username",s()):localStorage.removeItem("username");const e=await oe(s());N(e,(async e=>{try{const t=W(e.options),r=await q(t),o=await ne(e.session,r,s());X(o,(e=>{Z.success(n("login.success")),g(e.token),ae(decodeURIComponent(ie.redirect||p||"/"),!0)}))}catch(t){t instanceof Error&&Z.error(t.message)}}))}else{"true"===B()?(localStorage.setItem("username",s()),localStorage.setItem("password",w())):(localStorage.removeItem("username"),localStorage.removeItem("password"));const e=await re();X(e,(e=>{Z.success(n("login.success")),g(e.token),ae(decodeURIComponent(ie.redirect||p||"/"),!0)}),((e,t)=>{ue()||402!==t?Z.error(e):de(!0)}))}},[ue,de]=k(!1),ge=c("ldap_login_enabled"),pe=u("ldap_login_tips");return ge&&ee(!0),l(L,{zIndex:"1",w:"$full",h:"100vh",get children(){return[l(S,{get bgColor(){return i()},rounded:"$xl",p:"24px",w:{"@initial":"90%","@sm":"364px"},spacing:"$4",get children(){return[l(G,{alignItems:"center",justifyContent:"space-around",get children(){return[l(j,{mr:"$2",boxSize:"$12",get src(){return r()}}),l(z,{color:"$info9",fontSize:"$2xl",get children(){return o()}})]}}),l(U,{get when(){return!ue()},get fallback(){return l(E,{id:"totp",name:"otp",get placeholder(){return n("login.otp-tips")},get value(){return C()},onInput:e=>v(e.currentTarget.value),onKeyDown:e=>{"Enter"===e.key&&ce()}})},get children(){return[l(E,{name:"username",get placeholder(){return n("login.username-tips")},get value(){return s()},onInput:e=>h(e.currentTarget.value)}),l(U,{get when(){return!x()},get children(){return l(E,{name:"password",get placeholder(){return n("login.password-tips")},type:"password",get value(){return w()},onInput:e=>b(e.currentTarget.value),onKeyDown:e=>{"Enter"===e.key&&ce()}})}}),l(G,{px:"$1",w:"$full",fontSize:"$sm",color:"$neutral10",justifyContent:"space-between",alignItems:"center",get children(){return[l(R,{get checked(){return"true"===B()},onChange:()=>F("true"===B()?"false":"true"),get children(){return n("login.remember")}}),l(P,{as:"a",target:"_blank",get href(){return n("login.forget_url")},get children(){return n("login.forget")}})]}})]}}),l(T,{w:"$full",spacing:"$2",get children(){return[l(U,{get when(){return!x()},get children(){return l(D,{colorScheme:"primary",w:"$full",onClick:()=>{ue()?v(""):(h(""),b(""))},get children(){return n("login.clear")}})}}),l(D,{w:"$full",get loading(){return te()},onClick:ce,get children(){return n("login.login")}})]}}),l(U,{when:ge,get children(){return l(R,{w:"$full",get checked(){return!0===H()},onChange:()=>ee(!H()),children:pe})}}),l(D,{w:"$full",colorScheme:"accent",onClick:()=>{g(),ae(decodeURIComponent(ie.redirect||p||"/"),!0)},get children(){return n("login.use_guest")}}),l(G,{mt:"$2",justifyContent:"space-evenly",alignItems:"center",color:"$neutral10",w:"$full",get children(){return[l(M,{}),l(J,{}),l(Y,{}),l(U,{when:le,get children(){return l(f,{cursor:"pointer",boxSize:"$8",as:K,p:"$0_5",onclick:se})}})]}})]}}),l(V,{})]}})}))}}}));
