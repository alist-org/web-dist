import{b as O,d as q,cO as z,bb as d,e4 as B,q as H,e5 as D,e6 as M,x as e,bY as Q,ap as R,ai as m,bT as l,bG as c,L as h,bI as W,bJ as Y,ao as j,S as b,bK as G,W as $,dZ as f,d_ as S,d$ as J,aY as u,am as K,bN as N,bO as U,bP as V,av as k,bd as Z,bQ as A,Q as P,bt as v,n as x}from"./index-2768a655.js";const X=()=>{const n=O(),{params:C,back:g}=q(),{id:i}=C,[s,o]=z({name:"",description:"",permission:0,path_pattern:"/**"}),[_,y]=d(()=>B(parseInt(i))),w=async()=>{if(i){const r=await y();v(r,t=>{o({name:t.name,description:t.description,permission:t.permission,path_pattern:t.path_pattern})})}};H(()=>{w()});const I=()=>s.name.trim()?!0:(x.error(n("permissions.config.permissions_name")+n("global.required")),!1),[T,L]=d(async()=>I()?i?D({...s,id:parseInt(i)}):M(s):Promise.reject()),a=()=>u.filter((r,t)=>(s.permission>>t&1)===1),p=r=>{const t=1<<r;o("permission",s.permission^t)};return e(m,{spacing:"$2",alignItems:"start",w:"$full",get children(){return[e(Q,{get children(){return n(i?"global.edit":"global.add")}}),e(R,{get loading(){return _()},get children(){return e(m,{spacing:"$2",alignItems:"start",w:"$full",get children(){return[e(l,{required:!0,get children(){return[e(c,{get children(){return n("permissions.config.permissions_name")}}),e(h,{get value(){return s.name},onInput:r=>o("name",r.currentTarget.value)})]}}),e(l,{get children(){return[e(c,{get children(){return n("permissions.config.permissions_description")}}),e(h,{get value(){return s.description},onInput:r=>o("description",r.currentTarget.value)})]}}),e(l,{required:!0,get children(){return[e(c,{get children(){return n("permissions.config.permissions_permissions")}}),e(W,{multiple:!0,get value(){return a()},get children(){return[e(Y,{get children(){return e(j,{display:"flex",flexWrap:"wrap",gap:"$2",pr:"$6",py:"$2",minH:"40px",alignItems:"center",get children(){return e(b,{get when(){return a().length>0},get fallback(){return e(G,{get children(){return n("permissions.config.select_permissions")}})},get children(){return[e($,{get each(){return a().slice(0,3)},children:(r,t)=>e(f,{size:"lg",variant:"subtle",bgColor:"$neutral2",rounded:"$sm",px:"$3",py:"$1",get children(){return[e(S,{get children(){return n(`users.permissions.${r}`)}}),e(J,{onClick:F=>{F.stopPropagation(),p(u.indexOf(r))}})]}})}),e(b,{get when(){return a().length>3},get children(){return e(f,{size:"lg",variant:"subtle",bgColor:"$neutral2",rounded:"$sm",px:"$3",py:"$1",get children(){return e(S,{get children(){return["+",K(()=>a().length-3)]}})}})}})]}})}})}}),e(N,{get children(){return e(U,{get children(){return e($,{each:u,children:(r,t)=>e(V,{value:r,onClick:()=>p(t()),get children(){return e(k,{spacing:"$2",w:"$full",pl:"$4",fontSize:"$lg",get children(){return[e(Z,{get checked(){return(s.permission>>t()&1)===1},readOnly:!0}),e(A,{get children(){return n(`users.permissions.${r}`)}})]}})}})})}})}})]}})]}}),e(k,{spacing:"$2",get children(){return[e(P,{get loading(){return T()},onClick:async()=>{const r=await L();v(r,()=>{x.success(n("global.save_success")),g()})},get children(){return n("global.save")}}),e(P,{colorScheme:"accent",onClick:()=>g(),get children(){return n("global.back")}})]}})]}})}})]}})};export{X as default};
