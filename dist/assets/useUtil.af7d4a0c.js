import{a as y,N as p,P as v,bf as h,p as b,$ as x,bg as C,q as k,bh as d,s as g,u as D,n as L,bi as T,Q as R,bj as S}from"./index.2ea96c44.js";import{a as P}from"./api.bb9abe10.js";const E=(e,t,a="direct",r)=>{a!=="preview"&&(e=b(x().base_path,e)),e=C(e,!0);let n=`${e}/${t.name}`;n=k(n,r);let c=d,s=a==="direct"?"/d":"/p";a==="preview"&&(s="",d.startsWith(location.origin)||(c=location.origin));let o=`${c}${s}${n}`;return a!=="preview"&&t.sign&&(o+=`?sign=${t.sign}`),o},f=()=>{const{pathname:e}=y(),t=(r,n,c)=>{const s=p.state!==v.File?e():h(e());return E(s,r,n,c)},a=(r,n)=>t(r,"direct",n);return{getLinkByObj:t,rawLink:a,proxyLink:(r,n)=>t(r,"proxy",n),previewPage:(r,n)=>t(r,"preview",n),currentObjLink:r=>a(p.obj,r)}},j=()=>{const{previewPage:e,rawLink:t}=f(),a=r=>g().filter(n=>!n.is_dir).map(n=>t(n,r));return{rawLinks:a,previewPagesText:()=>g().map(r=>e(r,!0)).join(`
`),rawLinksText:r=>a(r).join(`
`)}},B=()=>{const{copy:e}=N(),{previewPagesText:t,rawLinksText:a}=j(),{currentObjLink:r}=f();return{copySelectedPreviewPage:()=>{e(t())},copySelectedRawLink:n=>{e(a(n))},copyCurrentRawLink:n=>{e(r(n))}}};var A=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,a=[],r=0;r<e.rangeCount;r++)a.push(e.getRangeAt(r));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null;break}return e.removeAllRanges(),function(){e.type==="Caret"&&e.removeAllRanges(),e.rangeCount||a.forEach(function(n){e.addRange(n)}),t&&t.focus()}},U=A,m={"text/plain":"Text","text/html":"Url",default:"Text"},$="Copy to clipboard: #{key}, Enter";function F(e){var t=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}function O(e,t){var a,r,n,c,s,o,l=!1;t||(t={}),a=t.debug||!1;try{n=U(),c=document.createRange(),s=document.getSelection(),o=document.createElement("span"),o.textContent=e,o.ariaHidden="true",o.style.all="unset",o.style.position="fixed",o.style.top=0,o.style.clip="rect(0, 0, 0, 0)",o.style.whiteSpace="pre",o.style.webkitUserSelect="text",o.style.MozUserSelect="text",o.style.msUserSelect="text",o.style.userSelect="text",o.addEventListener("copy",function(i){if(i.stopPropagation(),t.format)if(i.preventDefault(),typeof i.clipboardData>"u"){a&&console.warn("unable to use e.clipboardData"),a&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var u=m[t.format]||m.default;window.clipboardData.setData(u,e)}else i.clipboardData.clearData(),i.clipboardData.setData(t.format,e);t.onCopy&&(i.preventDefault(),t.onCopy(i.clipboardData))}),document.body.appendChild(o),c.selectNodeContents(o),s.addRange(c);var w=document.execCommand("copy");if(!w)throw new Error("copy command was unsuccessful");l=!0}catch(i){a&&console.error("unable to copy using execCommand: ",i),a&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),l=!0}catch(u){a&&console.error("unable to copy using clipboardData: ",u),a&&console.error("falling back to prompt"),r=F("message"in t?t.message:$),window.prompt(r,e)}}finally{s&&(typeof s.removeRange=="function"?s.removeRange(c):s.removeAllRanges()),o&&document.body.removeChild(o),n()}return l}var I=O;const N=()=>{const e=D(),{pathname:t}=y();return{copy:a=>{I(a),L.success(e("global.copied"))},isHide:a=>{const r=T();for(const n of r)if(n.test(b(t(),a.name)))return!0;return!1}}};function M(){const{proxyLink:e}=f();return R("",async()=>P(e(p.obj,!0)))}function _(e){const t=typeof e=="string";return{isString:t,text:(r="utf-8")=>e?t?e:S(e,r):""}}export{f as a,B as b,_ as c,N as d,M as e,E as g,j as u};
