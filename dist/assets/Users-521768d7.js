import{b as _,d as v,b9 as B,bq as h,B as T,dv as b,x as e,av as m,Q as l,ao as S,dw as U,dx as x,dy as $,W as f,dz as w,dA as F,dB as o,br as i,n as y,ai as H,cI as I,dH as L}from"./index-bcc8ecfe.js";import{b as W}from"./useTitle-3c2cdb8f.js";import{D}from"./DeletePopover-8333a4fa.js";import{W as q}from"./Wether-b974c050.js";const z=t=>{const[c,d]=T([]);(async()=>{const s=await L();i(s,n=>{d(n.content)})})();const u=s=>{switch(s){case 1:return"neutral";case 2:return"success";default:return"info"}};return e(m,{spacing:"$1",get children(){return e(f,{get each(){return t.role},children:s=>e(I,{get colorScheme(){return u(s)},get children(){var n;return(n=c().find(g=>g.id===s))==null?void 0:n.name}})})}})},Q=()=>{const t=_();W("manage.sidemenu.users");const{to:c}=v(),[d,p]=B(()=>h.get("/admin/user/list")),[u,s]=T([]),n=async()=>{const r=await p();i(r,a=>s(a.content))};n();const[g,k]=b(r=>h.post(`/admin/user/delete?id=${r}`)),[C,R]=b(r=>h.post(`/admin/user/cancel_2fa?id=${r}`));return e(H,{spacing:"$2",alignItems:"start",w:"$full",get children(){return[e(m,{spacing:"$2",get children(){return[e(l,{colorScheme:"accent",get loading(){return d()},onClick:n,get children(){return t("global.refresh")}}),e(l,{onClick:()=>{c("/@manage/users/add")},get children(){return t("global.add")}})]}}),e(S,{w:"$full",overflowX:"auto",get children(){return e(U,{highlightOnHover:!0,dense:!0,get children(){return[e(x,{get children(){return e($,{get children(){return[e(f,{each:["username","role","available"],children:r=>e(w,{get children(){return t(`users.${r}`)}})}),e(w,{get children(){return t("global.operations")}})]}})}}),e(F,{get children(){return e(f,{get each(){return u()},children:r=>e($,{get children(){return[e(o,{get children(){return r.username}}),e(o,{get children(){return e(z,{get role(){return r.role}})}}),e(o,{get children(){return e(q,{get yes(){return!r.disabled}})}}),e(o,{get children(){return e(m,{spacing:"$2",get children(){return[e(l,{onClick:()=>{c(`/@manage/users/edit/${r.id}`)},get children(){return t("global.edit")}}),e(D,{get name(){return r.username},get loading(){return g()===r.id},onClick:async()=>{const a=await k(r.id);i(a,()=>{y.success(t("global.delete_success")),n()})}}),e(l,{colorScheme:"accent",get loading(){return C()===r.id},onClick:async()=>{const a=await R(r.id);i(a,()=>{y.success(t("users.cancel_2fa_success")),n()})},get children(){return t("users.cancel_2fa")}})]}})}})]}})})}})]}})}})]}})};export{Q as default};
