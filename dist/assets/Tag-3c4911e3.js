import{b as R,d as H,B as n,al as F,q as I,x as e,av as f,Q as s,S as p,ao as N,dw as q,dx as z,dy as b,W as m,dz as S,dA as E,dB as c,cJ as J,cY as W,br as w,n as y,R as K,M as P,I as Q,J as V,K as X,O as Y,ai as j,dC as G,bq as C,dD as U}from"./index-ad495dea.js";import{g as Z,A as ee}from"./AddLabelDialog-bd243055.js";import{D as te}from"./DeletePopover-e2fc035a.js";const se=()=>{const a=R(),{to:$}=H(),[L,u]=n(!1),[_,d]=n(!1),[k,i]=n(null),[g,M]=n(!1),[T,o]=n(!1),O=async()=>{var t;try{const r=await C.get("/fs/list");return r.code===500&&((t=r.message)!=null&&t.includes("please add a storage first"))?(o(!0),!1):!0}catch(r){return console.error("Failed to check storage:",r),!1}},[x,{refetch:A}]=F(async()=>g()?await G():{data:{content:[],total:0}}),B=async t=>await C.post(`/admin/label/delete?id=${t}`),l=async()=>{try{u(!0);const t=await O();M(t),t&&await A()}catch{y.error(a("global.refresh_failed"))}finally{u(!1)}};I(()=>{l()});const D=(t,r,h)=>{l()},v=async t=>{const r=await U(t);w(r,h=>{i(h),d(!0)})};return e(j,{spacing:"$2",alignItems:"start",w:"$full",get children(){return[e(f,{spacing:"$2",get children(){return[e(s,{colorScheme:"accent",get loading(){return L()},onClick:l,get children(){return a("global.refresh")}}),e(p,{get when(){return g()},get children(){return e(s,{onClick:()=>{i(null),d(!0)},get children(){return a("global.add")}})}})]}}),e(p,{get when(){return g()},get children(){return e(N,{w:"$full",overflowX:"auto",get children(){return e(q,{highlightOnHover:!0,dense:!0,get children(){return[e(z,{get children(){return e(b,{get children(){return[e(m,{each:["name","description","create_time"],children:t=>e(S,{get children(){return a(`home.tag.${t}`)}})}),e(S,{get children(){return a("global.operations")}})]}})}}),e(E,{get children(){return e(m,{get each(){var t,r;return((r=(t=x())==null?void 0:t.data)==null?void 0:r.content)||[]},children:t=>e(b,{get children(){return[e(c,{get children(){return e(J,{get bgColor(){return Z(t.bg_color)},get color(){return t.bg_color},textTransform:"none",px:"$3",py:"$2",rounded:"$md",fontSize:"$sm",get children(){return t.name}})}}),e(c,{get children(){return t.description}}),e(c,{get children(){return W(t.create_time)}}),e(c,{get children(){return e(f,{spacing:"$2",get children(){return[e(s,{colorScheme:"accent",onClick:()=>v(t.id),get children(){return a("global.edit")}}),e(te,{get name(){return t.name},loading:!1,onClick:async()=>{const r=await B(t.id);w(r,()=>{y.success(a("global.delete_success")),l()})}})]}})}})]}})})}})]}})}})}}),e(ee,{get isOpen(){return _()},onClose:()=>{d(!1),i(null)},onSubmit:D,get editingLabel(){return k()}}),e(K,{get opened(){return T()},onClose:()=>o(!1),get children(){return[e(P,{}),e(Q,{get children(){return[e(V,{}),e(X,{get children(){return a("storages.no_storage_content")}}),e(Y,{get children(){return[e(s,{colorScheme:"accent",onClick:()=>o(!1),get children(){return a("global.cancel")}}),e(s,{onClick:()=>{o(!1),$("/@manage/storages")},ml:"$2",get children(){return a("home.go_to_storages")}})]}})]}})]}})]}})};export{se as default};
