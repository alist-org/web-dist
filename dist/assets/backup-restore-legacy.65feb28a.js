!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=l(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){c=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw o}}}}function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */o=function(){return t};var t={},r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(E){s=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof p?t:p,o=Object.create(i.prototype),a=new O(n||[]);return o._invoke=function(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return j()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var c=x(a,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=f(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(e,r,a),o}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(E){return{type:"throw",arg:E}}}t.wrap=l;var d={};function p(){}function m(){}function h(){}var g={};s(g,a,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(L([])));y&&y!==r&&n.call(y,a)&&(g=y);var v=h.prototype=p.prototype=Object.create(g);function _(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(t,r){function i(o,a,c,u){var s=f(t[o],t,a);if("throw"!==s.type){var l=s.arg,d=l.value;return d&&"object"==e(d)&&n.call(d,"__await")?r.resolve(d.__await).then((function(e){i("next",e,c,u)}),(function(e){i("throw",e,c,u)})):r.resolve(d).then((function(e){l.value=e,c(l)}),(function(e){return i("throw",e,c,u)}))}u(s.arg)}var o;this._invoke=function(e,t){function n(){return new r((function(r,n){i(e,t,r,n)}))}return o=o?o.then(n,n):n()}}function x(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var n=f(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,d;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function L(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:j}}function j(){return{value:void 0,done:!0}}return m.prototype=h,s(v,"constructor",h),s(h,"constructor",m),m.displayName=s(h,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s(e,u,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},_(w.prototype),s(w.prototype,c,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new w(l(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(v),s(v,u,"Generator"),s(v,a,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=L,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:L(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},t}function a(e,t,r,n,i,o,a){try{var c=e[o](a),u=c.value}catch(s){return void r(s)}c.done?t(u):Promise.resolve(u).then(n,i)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function c(e){a(o,n,i,c,u,"next",e)}function u(e){a(o,n,i,c,u,"throw",e)}c(void 0)}))}}function u(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,c=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(u){c=!0,i=u}finally{try{a||null==r.return||r.return()}finally{if(c)throw i}}return o}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}System.register(["./index-legacy.9633b485.js","./useTitle-legacy.3ffbaca9.js","./index-legacy.965df694.js"],(function(e,r){"use strict";var i,a,l,f,d,p,m,h,g,b,y,v,_,w,x,k,S,O,L;return{setters:[function(e){i=e.B,a=e.b,l=e.bb,f=e.bs,d=e.x,p=e.av,m=e.Q,h=e.bT,g=e.bZ,b=e.bG,y=e.bS,v=e.L,_=e.ai,w=e.W,x=e.ah,k=e.cE,S=e.n},function(e){O=e.b},function(e){L=e.c}],execute:function(){var r={success:{icon:"✅",color:"$success9"},error:{icon:"❌",color:"$danger9"},info:{icon:"ℹ️",color:"$info9"}},j=function(e){return d(p,{w:"$full",spacing:"$1",get children(){return[d(x,{get children(){return r[e.type].icon}}),d(x,{get color(){return r[e.type].color},get children(){return e.msg}})]}})};e("default",(function(){var e,r=s(i(!1),2),x=r[0],N=r[1],$=s(i(""),2),A=$[0],P=$[1],T=a();O("manage.sidemenu.backup-restore");var I=s(i([]),2),G=I[0],U=I[1],Y=function(t,r){U((function(e){return[].concat(u(e),[{type:r,msg:t}])})),e.scrollTop=e.scrollHeight},C=s(l((function(){return f.get("/label/list")})),2),D=C[0],F=C[1],B=s(l((function(e){return f.post("/admin/label/create",e)})),2),R=B[0],J=B[1],H=s(l((function(e){return f.post("/admin/label/update",e)})),2),M=H[0],Q=H[1],W=s(l((function(){return f.get("/admin/label_file_binding/list")})),2),Z=W[0],q=W[1],z=s(l((function(e){return f.post("/admin/label_file_binding/restore",e)})),2),K=z[0],V=z[1],X=s(l((function(){return f.get("/admin/role/list")})),2),ee=X[0],te=X[1],re=s(l((function(e){return f.post("/admin/role/create",e)})),2),ne=re[0],ie=re[1],oe=s(l((function(e){return f.post("/admin/role/update",e)})),2),ae=oe[0],ce=oe[1],ue=s(l((function(){return f.get("/admin/setting/list")})),2),se=ue[0],le=ue[1],fe=s(l((function(){return f.get("/admin/user/list")})),2),de=fe[0],pe=fe[1],me=s(l((function(){return f.get("/admin/meta/list")})),2),he=me[0],ge=me[1],be=s(l((function(){return f.get("/admin/storage/list")})),2),ye=be[0],ve=be[1];function _e(e,t){if(""==t)return e;var r=L.AES.encrypt(JSON.stringify(e),t).toString();return L.enc.Base64.stringify(L.enc.Utf8.parse(r))}function we(e,t,r,n){if(!n)return e;var i=L.enc.Base64.parse(e).toString(L.enc.Utf8);return r?L.AES.decrypt(i,t).toString(L.enc.Utf8):JSON.parse(L.AES.decrypt(i,t).toString(L.enc.Utf8))}var xe=function(){var e=c(o().mark((function e(){var t,r,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Y(T("br.start_backup"),"info"),t={encrypted:"",settings:[],users:[],storages:[],metas:[],labels:[],label_file_bindings:[],roles:[]},""!=A()&&(t.encrypted=_e("encrypted",A())),r=o().mark((function e(){var r,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i[n],e.next=3,r.fn();case 3:a=e.sent,k(a,(function(e){if(Y(T("br.success_backup_item",{item:T("manage.sidemenu.".concat(r.name))}),"success"),r.page){for(var n=0;n<e.content.length;n++){var i=e.content[n];for(var o in i)i[o]=_e(i[o],A())}t[r.name]=e.content}else{for(var a=0;a<e.length;a++){var c=e[a];for(var u in c)c[u]=_e(c[u],A())}t[r.name]=e}}),(function(e){Y(T("br.failed_backup_item",{item:T("manage.sidemenu.".concat(r.name))})+":"+e,"error")}));case 5:case"end":return e.stop()}}),e)})),n=0,i=[{name:"settings",fn:le,page:!1},{name:"users",fn:pe,page:!0},{name:"storages",fn:ve,page:!0},{name:"metas",fn:ge,page:!0},{name:"labels",fn:F,page:!0},{name:"label_file_bindings",fn:q,page:!0},{name:"roles",fn:te,page:!0}];case 5:if(!(n<i.length)){e.next=10;break}return e.delegateYield(r(),"t0",7);case 7:n++,e.next=5;break;case 10:E("alist_backup_"+(new Date).toLocaleString()+".json",t),Y(T("br.finish_backup"),"info");case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ke=s(l((function(e){return f.post("/admin/setting/save",e)})),2),Se=ke[0],Oe=ke[1],Le=s(l((function(e){return f.post("/admin/user/create",e)})),2),je=Le[0],Ee=Le[1],Ne=s(l((function(e){return f.post("/admin/storage/create",e)})),2),$e=Ne[0],Ae=Ne[1],Pe=s(l((function(e){return f.post("/admin/meta/create",e)})),2),Te=Pe[0],Ie=Pe[1],Ge=s(l((function(e){return f.post("/admin/user/update",e)})),2),Ue=Ge[0],Ye=Ge[1],Ce=s(l((function(e){return f.post("/admin/storage/update",e)})),2),De=Ce[0],Fe=Ce[1],Be=s(l((function(e){return f.post("/admin/meta/update",e)})),2),Re=Be[0],Je=Be[1];function He(e,t,r,n,i,o){return Me.apply(this,arguments)}function Me(){return(Me=c(o().mark((function e(t,r,n,i,a,c){var u,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r();case 2:u=e.sent.data.content,s=o().mark((function e(r){var s,l,f,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t[r],l=s[a],f=u.find((function(e){return e[a]===l})),d="add"===(f?"update":"add")?n:i,e.t0=k,e.next=8,d(s);case 8:return e.t1=e.sent,e.t2=function(){Y(T("br.success_restore_item",{item:T(c)})+"-"+"[".concat(l,"]"),"success")},e.t3=function(e){Y(T("br.failed_restore_item",{item:T(c)})+"-"+"[".concat(l,"]")+":"+e,"error")},e.next=13,(0,e.t0)(e.t1,e.t2,e.t3);case 13:case"end":return e.stop()}}),e)})),e.t0=o().keys(t);case 5:if((e.t1=e.t0()).done){e.next=10;break}return l=e.t1.value,e.delegateYield(s(l),"t2",8);case 8:e.next=5;break;case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Qe=function(){var e=c(o().mark((function e(){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Y(T("br.start_restore"),"info"),(r=document.createElement("input")).type="file",r.accept="application/json",r.onchange=function(){var e=c(o().mark((function e(r){var i,a,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=r.target.files)&&0!==i.length){e.next=4;break}return S.warning(T("br.no_file")),e.abrupt("return");case 4:a=i[0],(u=new FileReader).onload=c(o().mark((function e(){var r,i,a,c,s,l,f,d,p,m,h,g,b,y,v,_,w,S,O,L,j,E;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=JSON.parse(u.result),!(i=Boolean(r.encrypted))){e.next=6;break}if('"encrypted"'===we(r.encrypted,A(),!0,!0)){e.next=6;break}return Y(T("br.wrong_encrypt_password"),"error"),e.abrupt("return");case 6:for(a=0,c=["settings","users","storages","metas","labels","label_file_bindings","roles"];a<c.length;a++)for(s=r[c[a]]||[],l=0;l<s.length;l++)for(d in f=s[l])f[d]=we(f[d],A(),!1,i);if(!x()){e.next=11;break}return e.next=11,xe();case 11:if(e.t0=r.settings,!e.t0){e.next=20;break}return e.t1=k,e.next=16,Oe(r.settings.filter((function(e){return!["version","index_progress"].includes(e.key)})));case 16:e.t2=e.sent,e.t3=function(){Y(T("br.success_restore_item",{item:T("manage.sidemenu.settings")}),"success")},e.t4=function(e){Y(T("br.failed_restore_item",{item:T("manage.sidemenu.settings")})+":"+e,"error")},(0,e.t1)(e.t2,e.t3,e.t4);case 20:if(!x()){e.next=45;break}return p=(r.label_file_bindings||[]).map((function(e){var t;return n(n({},e),{},{id:"string"==typeof e.id?Number(e.id):e.id,user_id:"string"==typeof e.user_id?Number(e.user_id):e.user_id,label_id:"string"==typeof e.label_id?Number(e.label_id):e.label_id,file_name:String(null!==(t=e.file_name)&&void 0!==t?t:"")})})),e.next=24,He(r.users,pe,Ee,Ye,"username","manage.sidemenu.users");case 24:return e.next=26,He(r.storages,ve,Ae,Fe,"mount_path","manage.sidemenu.storages");case 26:return e.next=28,He(r.metas,ge,Ie,Je,"path","manage.sidemenu.metas");case 28:return e.next=30,He(r.labels,F,J,Q,"id","manage.sidemenu.labels");case 30:if(!p.length){e.next=39;break}return e.t5=k,e.next=34,V({keep_ids:!0,override:!0,bindings:p});case 34:return e.t6=e.sent,e.t7=function(){Y(T("br.success_restore_item",{item:T("manage.sidemenu.label_file_bindings")}),"success")},e.t8=function(e){Y(T("br.failed_restore_item",{item:T("manage.sidemenu.label_file_bindings")})+":"+e,"error")},e.next=39,(0,e.t5)(e.t6,e.t7,e.t8);case 39:return m=new Set(["admin"]),h=(r.roles||[]).filter((function(e){var t,r=String(null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"").toLowerCase();return!m.has(r)||(Y(T("br.success_restore_item",{item:T("manage.sidemenu.roles")})+" - [".concat(e.name,"] skipped (builtin role)"),"info"),!1)})),e.next=43,He(h,te,ie,ce,"name","manage.sidemenu.roles");case 43:e.next=98;break;case 45:g=(r.users||[]).filter((function(e){var t,r=String(null!==(t=null==e?void 0:e.username)&&void 0!==t?t:"").toLowerCase();return"admin"!==r&&"guest"!==r||(Y(T("br.success_restore_item",{item:T("manage.sidemenu.users")})+" - [".concat(e.username,"] skipped (builtin user)"),"info"),!1)})),b=t(g),e.prev=47,v=o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=y.value).id=0,e.t0=k,e.next=5,Ee(t);case 5:return e.t1=e.sent,e.t2=function(){Y(T("br.success_restore_item",{item:T("manage.sidemenu.users")})+"-"+"[".concat(t.username,"]"),"success")},e.t3=function(e){Y(T("br.failed_restore_item",{item:T("manage.sidemenu.users")})+" [ ".concat(t.username," ] :")+e,"error")},e.next=10,(0,e.t0)(e.t1,e.t2,e.t3);case 10:case"end":return e.stop()}}),e)})),b.s();case 50:if((y=b.n()).done){e.next=54;break}return e.delegateYield(v(),"t9",52);case 52:e.next=50;break;case 54:e.next=59;break;case 56:e.prev=56,e.t10=e.catch(47),b.e(e.t10);case 59:return e.prev=59,b.f(),e.finish(59);case 62:_=o().mark((function e(){var r,n,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=S[w],n=t(r.data||[]),e.prev=2,a=o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=i.value).id=0,e.t0=k,e.next=5,r.fn(t);case 5:return e.t1=e.sent,e.t2=function(){Y(T("br.success_restore_item",{item:T("manage.sidemenu.".concat(r.name))})+"-"+"[".concat(t[r.key],"]"),"success")},e.t3=function(e){Y(T("br.failed_restore_item",{item:T("manage.sidemenu.".concat(r.name))})+" [ ".concat(t[r.key]," ] :")+e,"error")},e.next=10,(0,e.t0)(e.t1,e.t2,e.t3);case 10:case"end":return e.stop()}}),e)})),n.s();case 5:if((i=n.n()).done){e.next=9;break}return e.delegateYield(a(),"t0",7);case 7:e.next=5;break;case 9:e.next=14;break;case 11:e.prev=11,e.t1=e.catch(2),n.e(e.t1);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[2,11,14,17]])})),w=0,S=[{name:"storages",fn:Ae,data:r.storages,key:"mount_path"},{name:"metas",fn:Ie,data:r.metas,key:"path"},{name:"labels",fn:J,data:r.labels,key:"name"}];case 64:if(!(w<S.length)){e.next=69;break}return e.delegateYield(_(),"t11",66);case 66:w++,e.next=64;break;case 69:O=t(r.roles||[]),e.prev=70,j=o().mark((function e(){var t,r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=L.value,n=String(null!==(t=null==r?void 0:r.name)&&void 0!==t?t:"").toLowerCase(),!["admin","guest","general"].includes(n)){e.next=5;break}return Y(T("br.success_restore_item",{item:T("manage.sidemenu.roles")})+" - [".concat(r.name,"] skipped (builtin role)"),"info"),e.abrupt("return","continue");case 5:return"id"in r&&delete r.id,e.t0=k,e.next=9,ie(r);case 9:return e.t1=e.sent,e.t2=function(){Y(T("br.success_restore_item",{item:T("manage.sidemenu.roles")})+"-"+"[".concat(r.name,"]"),"success")},e.t3=function(e){Y(T("br.failed_restore_item",{item:T("manage.sidemenu.roles")})+"-"+"[".concat(r.name,"]:")+e,"error")},e.next=14,(0,e.t0)(e.t1,e.t2,e.t3);case 14:case"end":return e.stop()}}),e)})),O.s();case 73:if((L=O.n()).done){e.next=80;break}return e.delegateYield(j(),"t12",75);case 75:if("continue"!==e.t12){e.next=78;break}return e.abrupt("continue",78);case 78:e.next=73;break;case 80:e.next=85;break;case 82:e.prev=82,e.t13=e.catch(70),O.e(e.t13);case 85:return e.prev=85,O.f(),e.finish(85);case 88:if(!(E=(r.label_file_bindings||[]).map((function(e){var t;return n(n({},e),{},{id:"string"==typeof e.id?Number(e.id):e.id,user_id:"string"==typeof e.user_id?Number(e.user_id):e.user_id,label_id:"string"==typeof e.label_id?Number(e.label_id):e.label_id,file_name:String(null!==(t=e.file_name)&&void 0!==t?t:"")})}))).length){e.next=98;break}return e.t14=k,e.next=93,V({keep_ids:!0,override:!1,bindings:E});case 93:return e.t15=e.sent,e.t16=function(){Y(T("br.success_restore_item",{item:T("manage.sidemenu.label_file_bindings")}),"success")},e.t17=function(e){Y(T("br.failed_restore_item",{item:T("manage.sidemenu.label_file_bindings")})+":"+e,"error")},e.next=98,(0,e.t14)(e.t15,e.t16,e.t17);case 98:Y(T("br.finish_restore"),"info");case 99:case"end":return e.stop()}}),e,null,[[47,56,59,62],[70,82,85,88]])}))),u.readAsText(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.click();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return d(_,{spacing:"$2",w:"$full",get children(){return[d(p,{spacing:"$2",w:"$full",get children(){return[d(m,{get loading(){return se()||de()||he()||ye()||D()||Z()||ee()},onClick:function(){xe()},colorScheme:"accent",get children(){return T("br.backup")}}),d(m,{get loading(){return Se()||je()||$e()||Te()||R()||ne()||Ue()||De()||Re()||M()||ae()||K()},onClick:function(){Qe()},get children(){return T("br.restore")}})]}}),d(h,{w:"$full",display:"flex",flexDirection:"column",get children(){return d(g,{w:"$full",direction:"column",gap:"$1",get children(){return[d(b,{for:"restore-override",get children(){return T("br.override")}}),d(y,{id:"restore-override",get checked(){return x()},onChange:function(e){return N(e.currentTarget.checked)}}),d(b,{for:"password",get children(){return T("br.encrypt_password")}}),d(v,{id:"password",type:"password",get placeholder(){return T("br.encrypt_password_placeholder")},onInput:function(e){return P(e.currentTarget.value)}})]}})}}),d(_,{p:"$2",ref:function(t){"function"==typeof e?e(t):e=t},w:"$full",alignItems:"start",rounded:"$md",h:"70vh",bg:"$neutral3",overflowY:"auto",spacing:"$1",get children(){return d(w,{get each(){return G()},children:function(e){return d(j,e)}})}})]}})}));function E(e,t){var r=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=e,i.click(),URL.revokeObjectURL(n)}}}}))}();
