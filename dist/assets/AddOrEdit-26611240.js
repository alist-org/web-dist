import{b as R,d as D,B as H,cH as O,b9 as c,dH as _,bq as p,x as e,bW as q,ap as B,ai as h,S as b,bR as o,bE as d,L as f,bG as F,bH as z,ao as W,bI as E,W as m,d$ as M,e0 as P,e1 as U,bL as A,bM as G,bN as N,av as Q,bb as w,bO as V,Q as j,br as u,n as J}from"./index-bcc8ecfe.js";const Y=()=>{const n=R(),{params:$,back:x}=D(),{id:l}=$,[g,y]=H([]),[t,s]=O({id:0,username:"",password:"",base_path:"",role:[],permission:0,disabled:!1,sso_id:"",role_info:[],permissions:[]}),[S,k]=c(()=>_()),[C,v]=c(()=>p.get(`/admin/user/get?id=${l}`));(async()=>{const r=await k();if(u(r,a=>{y(a.content)}),l){const a=await v();u(a,s)}})();const[L,I]=c(()=>p.post(`/admin/user/${l?"update":"create"}`,t));return e(h,{spacing:"$2",alignItems:"start",w:"$full",get children(){return[e(q,{get children(){return n(l?"global.edit":"global.add")}}),e(B,{get loading(){return C()||S()},get children(){return e(h,{spacing:"$2",alignItems:"start",w:"$full",get children(){return[e(b,{get when(){return!l||!(t.role_info||[]).includes(1)},get children(){return[e(o,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[e(d,{for:"username",display:"flex",alignItems:"center",get children(){return n("users.username")}}),e(f,{id:"username",get value(){return t.username},onInput:r=>s("username",r.currentTarget.value)})]}}),e(o,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[e(d,{for:"password",display:"flex",alignItems:"center",get children(){return n("users.password")}}),e(f,{id:"password",type:"password",placeholder:"********",get value(){return t.password},onInput:r=>s("password",r.currentTarget.value)})]}})]}}),e(o,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[e(d,{display:"flex",alignItems:"center",get children(){return n("users.role")}}),e(F,{get value(){return t.role},onChange:r=>s("role",r),get children(){return[e(z,{get children(){return e(W,{display:"flex",flexWrap:"wrap",gap:"$2",pr:"$6",py:"$2",minH:"40px",alignItems:"center",get children(){return e(b,{get when(){return t.role.length>0},get fallback(){return e(E,{get children(){return n("home.selected")}})},get children(){return e(m,{get each(){return t.role},children:r=>{const a=g().find(i=>i.id===r);return e(M,{size:"lg",variant:"subtle",bgColor:"$neutral2",rounded:"$sm",px:"$3",py:"$1",get children(){return[e(P,{get children(){return(a==null?void 0:a.name)||`ID: ${r}`}}),e(U,{onClick:i=>{i.stopPropagation(),s("role",t.role.filter(T=>T!==r))}})]}})}})}})}})}}),e(A,{get children(){return e(G,{get children(){return e(m,{get each(){return g()},children:r=>e(N,{get value(){return r.id},onClick:()=>{const a=t.role.includes(r.id)?t.role.filter(i=>i!==r.id):[r.id];s("role",a)},get children(){return e(Q,{spacing:"$2",w:"$full",pl:"$4",fontSize:"$lg",get children(){return[e(w,{get checked(){return t.role.includes(r.id)},readOnly:!0}),e(V,{get children(){return r.name}})]}})}})})}})}})]}})]}}),e(o,{w:"fit-content",display:"flex",get children(){return e(w,{css:{whiteSpace:"nowrap"},id:"disabled",onChange:r=>s("disabled",r.currentTarget.checked),color:"$neutral10",fontSize:"$sm",get checked(){return t.disabled},get children(){return n("users.disabled")}})}}),e(j,{get loading(){return L()},onClick:async()=>{const r=await I();u(r,()=>{J.success(n("global.save_success")),x()})},get children(){return n("global.save")}})]}})}})]}})};export{Y as default};
