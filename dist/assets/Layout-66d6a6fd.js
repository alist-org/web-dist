import{u as en,b as O,d as P,e as I,n as B,g as Dt,i as tn,j as Q,k as nn,l as rn,_ as Ke,o as ke,q as Xe,r as A,x as e,P as on,y as an,z as sn,A as K,B as k,C as ln,D as Ne,E as ut,F as cn,G as un,H as Be,M as oe,I as ae,J as se,K as ie,S as v,L as $e,T as dn,N as gn,O as me,Q as D,R as le,U as z,V as Le,W as Se,X as hn,Y as fn,Z as mn,$ as Ye,a0 as Pt,a1 as Ve,a2 as pn,a3 as bn,a4 as Me,a5 as ve,a6 as xe,a7 as Je,a8 as _n,a9 as Ze,aa as We,ab as Qe,ac as J,ad as E,ae as wn,af as U,ag as yn,ah as ce,ai as ee,aj as kn,ak as $n,al as Nt,am as ne,an as gt,ao as Ce,ap as Cn,aq as Bt,ar as Sn,as as vn,at as xn,au as et,av as W,aw as On,ax as Te,ay as Ae,az as de,aA as ht,aB as Ln,aC as fe,aD as at,aE as jt,aF as Ut,aG as zt,aH as ft,aI as he,aJ as Mn,aK as Tn,aL as mt,aM as An,aN as In,aO as m,aP as tt,aQ as Rn,aR as En,aS as st,aT as Ht,aU as Fn,aV as Dn,aW as Pn,aX as Nn,aY as Bn,aZ as pt,a_ as jn,a$ as F,b0 as re,b1 as Un,b2 as zn,b3 as yt,b4 as Hn,b5 as Vt,b6 as Vn,b7 as kt,b8 as Wn,b9 as Gn,ba as qn,bb as Kn,bc as Xn,bd as Yn,be as X,bf as Jn,bg as Ie,bh as Z,bi as Zn,bj as Qn,bk as er,bl as tr,bm as nr,bn as rr,bo as or,bp as ar,bq as it,br as sr,bs as ir,bt as lr,bu as $t,bv as cr,bw as ur,bx as dr,by as Ct,bz as Wt,bA as gr,bB as hr,bC as fr,bD as mr,bE as pr,bF as br,bG as _r,bH as wr,bI as yr,bJ as De,bK as lt,bL as dt,bM as kr,bN as $r,bO as Cr,bP as Sr,bQ as vr,bR as xr,bS as Or,bT as Lr,bU as Mr,bV as Tr,bW as Pe,bX as Ar,bY as St,bZ as Ir,b_ as Rr,b$ as Er,c0 as Fr,c1 as Dr}from"./index-13b290a7.js";import{u as Pr,a as Nr}from"./useTitle-efd03a2a.js";import{L as Br,A as jr,C as Ur,T as zr,a as Hr,b as Vr,c as Wr,d as Gr,e as qr,f as Kr,B as Xr,g as Yr,h as Jr,i as vt,j as Zr,k as Qr}from"./index-c1c6ff9d.js";import{F as eo,M as nt}from"./FolderTree-6f54b0b0.js";import{R as to}from"./index-69644529.js";import{c as Ge}from"./index-8034ec29.js";import{n as xt}from"./storage-class-1ac53f89.js";function He(t){return t==null||t===""}function no(t){return t==null}async function ro(t,n){let o="/downloads/alist";const r=await Dt.post(t,{id:Math.random().toString(),jsonrpc:"2.0",method:"aria2.getGlobalOption",params:["token:"+n]});return console.log(r),r.status===200&&(He(r.data.result.dir)||(o=r.data.result.dir),o=o.endsWith("/")?o.slice(0,-1):o),o}const oo=()=>{const{rawLinks:t}=en(),n=O(),{pathname:o}=P();return{batchDownloadSelected:()=>{t(!0).forEach(a=>{window.open(a,"_blank")})},sendToAria2:async()=>{const r=I(),a=async(i,c)=>{if(c.is_dir){const d=await rn(Q(o(),i,c.name),Ke());if(d.code!==200)return d.message;const g=[];for(const u of d.data.content??[]){const w=await a(Q(i,c.name),u);if(typeof w=="string")return w;g.push(...w)}return g}else return[{path:Q(i,c.name),dir:i,url:nn(Q(o(),i),c,"direct",!0),name:c.name}]},{aria2_rpc_url:s,aria2_rpc_secret:l}=ke;if(!s){B.warning(n("home.toolbar.aria2_not_set"));return}try{let i="/downloads/alist";i=await ro(s,l);let c=!1;B.info(`${n("home.package_download.fetching_struct")}`);for(const d of r){const g=await a("",d);if(typeof g!="object"||g.length===void 0)return B.error(`${n("home.package_download.fetching_struct_failed")}: ${g}`),g;for(let u=0;u<g.length;u++){if(He(g[u].path)||no(g[u].dir)||He(g[u].url)||He(g[u].name)){B.error(`${n("home.package_download.fetching_struct_failed")}: ${JSON.stringify(g[u])}`);continue}c||(c=!0,B.info(`${n("home.package_download.downloading")}`));const w=await Dt.post(s,{id:Math.random().toString(),jsonrpc:"2.0",method:"aria2.addUri",params:["token:"+l,[g[u].url],{out:g[u].name,dir:i+g[u].dir,"check-certificate":"false"}]});console.log(w)}}B.success(n("home.toolbar.send_aria2_success"))}catch(i){console.error(i),B.error(`failed to send to aria2: ${i}`)}},playlistDownloadSelected:()=>{const r=I().filter(c=>!c.is_dir);let a=tn(o());r.length===1&&(a=r[0].name),a||(a=n("manage.sidemenu.home"));const s=r.reduce((c,d,g)=>`${c}#EXTINF:-1,${d.name}
${t(!0)[g]}
`,`#EXTM3U
`),l=new Blob([s],{type:"application/x-mpegURL"}),i=document.createElement("a");i.href=URL.createObjectURL(l),i.download=`${a}.m3u8`,i.click(),URL.revokeObjectURL(i.href)}}},ao=t=>(t=Array.isArray(t)?t[0]:t,t instanceof Element?t:void 0),so=(t,n)=>{const o={once:!0};t.addEventListener("motioncomplete",n,o),A(t.removeEventListener.bind(t,"motioncomplete",n,o))},io=t=>{let{initial:n=!0}=t;Xe(()=>n=!0);let o=!1,r=[],a=[],s=[];return A(()=>{s.concat(a).forEach(l=>l()),a=s=r=[]}),e(un.Provider,{value:{addCleanup:l=>a.push(l),addMount:l=>r.push(l),initial:()=>n},get children(){return e(on.Provider,{value:void 0,get children(){return an(()=>{const l=sn(()=>t.children),i=K(()=>ao(l())),[c,d]=k(),[g,u]=k();return ln(Ne(i,p=>{s.push(...a),a=[],ut(()=>{t.exitBeforeEnter?(d(),h(()=>!o&&w(p))):(w(p),h())})})),[c,g];function w(p){d(p),r.forEach(L=>L()),r=[]}function h(p){const L=()=>{u(),s.forEach(M=>M()),s=[],p==null||p()},j=u(c()??g());if(!j)return L();const y=cn.get(j);if(!y||!y.getOptions().exit)return L();y.setActive("exit",o=!0),so(j,()=>{o=!1,L()})}})}})}})},rt=t=>{const[n,o]=k(t.defaultValue??""),r=O();let a;const s=()=>{const i=n().lastIndexOf(".");setTimeout(()=>{i>0&&t.isRenamingFile?a.setSelectionRange(0,i):a.select()},10)};Be(()=>{a&&(a.focus(),s()),A(()=>{a&&a.setSelectionRange(0,0)})}),Be(()=>{t.opened||o("")});const l=()=>{var i;if(!n()){B.warning(r("global.empty_input"));return}(i=t.onSubmit)==null||i.call(t,n())};return e(le,{blockScrollOnMount:!1,get opened(){return t.opened},get onClose(){return t.onClose},initialFocus:"#modal-input",get children(){return[e(oe,{}),e(ae,{onDrop:i=>{var c;return(c=t.onDrop)==null?void 0:c.call(t,i,o)},get children(){return[e(se,{get children(){return r(t.title)}}),e(ie,{get children(){return[e(v,{get when(){return t.topSlot},get children(){return t.topSlot}}),e(v,{get when(){return t.type==="text"},get fallback(){return e($e,{id:"modal-input",get type(){return t.type},get value(){return n()},ref:i=>a=i,onInput:i=>{o(i.currentTarget.value)},onFocus:s,onKeyDown:i=>{i.key==="Enter"&&l()}})},get children(){return e(dn,{id:"modal-input",get value(){return n()},ref:i=>a=i,onInput:i=>{o(i.currentTarget.value)},onFocus:s})}}),e(v,{get when(){return t.tips},get children(){return e(gn,{get children(){return t.tips}})}}),e(v,{get when(){return t.bottomSlot},get children(){return t.bottomSlot}})]}}),e(me,{display:"flex",gap:"$2",get children(){return[e(v,{get when(){return t.footerSlot},get children(){return t.footerSlot}}),e(D,{get onClick(){return t.onClose},colorScheme:"neutral",get children(){return r("global.cancel")}}),e(D,{get loading(){return t.loading},onClick:()=>l(),get children(){return r("global.ok")}})]}})]}})]}})},lo=()=>{const{pathname:t}=P(),n=K(()=>["",...t().split("/").filter(Boolean)]),o=O(),{setPathAs:r}=z(),a=K(()=>{const s={_after:{content:"",bgColor:"$background",position:"absolute",height:"100%",width:"99vw",zIndex:-1,transform:"translateX(-50%)",left:"50%",top:0}};switch(ke.position_of_header_navbar){case"only_navbar_sticky":return{...s,position:"sticky",zIndex:"$sticky",top:0};case"sticky":return{...s,position:"sticky",zIndex:"$sticky",top:60};default:return{_after:void 0,position:void 0,zIndex:void 0,top:void 0}}});return e(bn,Le(a,{background:"$background",class:"nav",w:"$full",get children(){return e(Se,{get each(){return n()},children:(s,l)=>{const i=K(()=>l()===n().length-1),c=n().slice(0,l()+1).join("/"),d=hn(c);let g=()=>s;return g()===""&&(g=()=>Me("home_icon")+o("manage.sidemenu.home")),e(fn,{class:"nav-item",get children(){return[e(mn,{class:"nav-link",css:{wordBreak:"break-all"},color:"unset",get _hover(){return{bgColor:Ye(),color:"unset"}},_active:{transform:"scale(.95)",transition:"0.1s"},cursor:"pointer",p:"$1",rounded:"$lg",get currentPage(){return i()},get as(){return i()?void 0:Pt},get href(){return Ve(d)},onMouseEnter:()=>r(c),children:g}),e(v,{get when(){return!i()},get children(){return e(pn,{class:"nav-separator"})}})]}})}})}}))},co=ve(()=>xe(()=>import("./Folder-015eb94d.js"),["assets/Folder-015eb94d.js","assets/index-13b290a7.js","assets/index-b206f97b.css","assets/style-a91f2fe1.js","assets/style-a6d16836.css","assets/video_box-06f63821.js","assets/index-8034ec29.js","assets/Paginator-6b8b297f.js","assets/index-c1c6ff9d.js","assets/useTitle-efd03a2a.js","assets/FolderTree-6f54b0b0.js","assets/index-69644529.js","assets/storage-class-1ac53f89.js","assets/Folder-6ee8584f.css"])),uo=ve(()=>xe(()=>import("./File-d8b1045a.js").then(t=>t.a),["assets/File-d8b1045a.js","assets/index-13b290a7.js","assets/index-b206f97b.css","assets/storage-class-1ac53f89.js","assets/index-c1c6ff9d.js"])),go=ve(()=>xe(()=>import("./Password-eb061964.js"),["assets/Password-eb061964.js","assets/index-13b290a7.js","assets/index-b206f97b.css"])),[ho,fo]=k(),mo=()=>{const t=O(),n=Je("white","$neutral3"),{pathname:o,searchParams:r}=P(),{handlePathChange:a,refresh:s}=z(),l=_n(),i=K(()=>l.type==="pagination"?parseInt(r.page,10)||1:void 0);let c,d;return Be(Ne([o,i],async([g,u])=>{c&&kn(c,d),c=g,d=u,Pr(),await a(g,u)})),e(ee,{ref:g=>fo(g),class:"obj-box",w:"$full",rounded:"$xl",get bgColor(){return n()},p:"$2",shadow:"$lg",spacing:"$2",get children(){return e(Ze,{get fallback(){return e(We,{})},get children(){return e(Qe,{get children(){return[e(J,{get when(){return E.err},get children(){return e(wn,{get msg(){return E.err},disableColor:!0})}}),e(J,{get when(){return[U.FetchingObj,U.FetchingObjs].includes(E.state)},get children(){return e(We,{})}}),e(J,{get when(){return E.state===U.NeedPassword},get children(){return e(go,{get title(){return t("home.input_password")},password:Ke,setPassword:yn,enterCallback:()=>s(!0),get children(){return[e(ce,{get children(){return t("global.have_account")}}),e(ce,{color:"$info9",as:Br,get href(){return`/@login?redirect=${encodeURIComponent(location.pathname)}`},get children(){return t("global.go_login")}})]}})}}),e(J,{get when(){return[U.Folder,U.FetchingMore].includes(E.state)},get children(){return e(co,{})}}),e(J,{get when(){return E.state===U.File},get children(){return e(uo,{})}})]}})}})}})};function Ot(t){const n=Je("white","$neutral3"),{proxyLink:o}=$n();P();const r=K(Ne(()=>E.state,()=>{if(![U.FetchingMore,U.Folder,U.File].includes(E.state))return"";if([U.FetchingMore,U.Folder].includes(E.state)){const l=E.objs.find(i=>t.files.find(c=>c.toLowerCase()===i.name.toLowerCase()));if(l)return o(l,!0)}return E[t.fromMeta]&&typeof E[t.fromMeta]=="string"?E[t.fromMeta]:""})),a=async l=>{let i={content:l};return/^https?:\/\//g.test(l)&&(i=await Sn(l)),i},[s]=Nt(r,a);return e(v,{get when(){return ne(()=>!!gt("readme_autorender"),!0)()&&r()},get children(){return e(Ce,{w:"$full",rounded:"$xl",p:"$4",get bgColor(){return n()},shadow:"$lg",get children(){return e(Cn,{get loading(){return s.loading},get children(){return e(Bt,{get children(){var l;return(l=s())==null?void 0:l.content},readme:!0,get toc(){return t.fromMeta==="readme"}})}})}})}})}const Gt=t=>{const n=Me("home_container");return e(Qe,{get fallback(){return e(Ce,{w:"min(99%, 980px)",get children(){return t.children}})},get children(){return e(J,{when:n==="hope_container",get children(){return e(vn,{get children(){return t.children}})}})}})};function po(){const{to:t}=P(),n=xn(),[o,r]=k(),[a,s]=k(),[l,i]=k(-999),c=()=>i(0),d=()=>{const u=ho(),w=a();if(!u||!w)return;const h=u.offsetLeft>50?16:0;w.clientWidth<u.offsetLeft-h?i(0):i(`calc(-100% + ${u.offsetLeft}px - ${h}px)`)};let g;return Xe(()=>{const u=o();u==null||u.setPath(n.pathname),g=requestAnimationFrame(d),window.addEventListener("resize",d),A(()=>window.removeEventListener("resize",d))}),Be(Ne(()=>E.state,()=>{cancelAnimationFrame(g),g=requestAnimationFrame(d)})),Be(Ne(()=>n.pathname,()=>{const u=o();u==null||u.setPath(n.pathname)})),e(Ce,{get as(){return et.div},initial:{x:-999},get animate(){return{x:l()}},zIndex:"$overlay",pos:"fixed",left:3,top:3,h:"calc(100vh - 6px)",minW:180,p:"$2",overflow:"auto",shadow:"$lg",rounded:"$lg",bgColor:"white",_dark:{bgColor:"$neutral3"},onMouseEnter:c,onMouseLeave:d,ref:u=>s(u),get children(){return e(eo,{autoOpen:!0,showEmptyIcon:!0,showHiddenFolder:!1,onChange:u=>t(u),handle:u=>r(u)})}})}function bo(){const t=K(()=>ke.show_sidebar!=="none");return e(v,{get when(){return t()},get children(){return e(po,{})}})}const _o=()=>e(Gt,{get children(){return e(ee,{class:"body",mt:"$1",py:"$2",px:"2%",minH:"80vh",w:"$full",gap:"$4",get children(){return[e(Ot,{files:["header.md","top.md","index.md"],fromMeta:"header"}),e(lo,{}),e(mo,{}),e(Ot,{files:["readme.md","footer.md","bottom.md"],fromMeta:"readme"}),e(bo,{})]}})}}),wo=de("<span>|</span>"),yo=()=>{const t=O();return e(ee,{class:"footer",w:"$full",py:"$4",get children(){return e(W,{spacing:"$1",get children(){return[e(On,{href:"https://github.com/alist-org/alist",external:!0,get children(){return t("home.footer.powered_by")}}),wo.cloneNode(!0),e(jr,{as:Pt,get href(){return Te.is_guest(Ae())?"/@login":"/@manage"},get children(){return t(Te.is_guest(Ae())?"login.login":"home.footer.manage")}})]}})}})},Lt={black:"#000",silver:"#C0C0C0",gray:"#808080",white:"#FFF",maroon:"#800000",red:"#F00",purple:"#800080",fuchsia:"#F0F",green:"#008000",lime:"#0F0",olive:"#808000",yellow:"#FF0",navy:"#000080",blue:"#00F",teal:"#008080",aqua:"#0FF",transparent:"#0000"},Re="^\\s*",Ee="\\s*$",_e="\\s*((\\.\\d+)|(\\d+(\\.\\d*)?))\\s*",we="([0-9A-Fa-f])",ye="([0-9A-Fa-f]{2})",ko=new RegExp(`${Re}rgb\\s*\\(${_e},${_e},${_e}\\)${Ee}`),$o=new RegExp(`${Re}rgba\\s*\\(${_e},${_e},${_e},${_e}\\)${Ee}`),Co=new RegExp(`${Re}#${we}${we}${we}${Ee}`),So=new RegExp(`${Re}#${ye}${ye}${ye}${Ee}`),vo=new RegExp(`${Re}#${we}${we}${we}${we}${Ee}`),xo=new RegExp(`${Re}#${ye}${ye}${ye}${ye}${Ee}`);function H(t){return parseInt(t,16)}function qt(t){try{let n;if(n=So.exec(t))return[H(n[1]),H(n[2]),H(n[3]),1];if(n=ko.exec(t))return[te(n[1]),te(n[5]),te(n[9]),1];if(n=$o.exec(t))return[te(n[1]),te(n[5]),te(n[9]),ct(n[13])];if(n=Co.exec(t))return[H(n[1]+n[1]),H(n[2]+n[2]),H(n[3]+n[3]),1];if(n=xo.exec(t))return[H(n[1]),H(n[2]),H(n[3]),ct(H(n[4])/255)];if(n=vo.exec(t))return[H(n[1]+n[1]),H(n[2]+n[2]),H(n[3]+n[3]),ct(H(n[4]+n[4])/255)];if(t in Lt)return qt(Lt[t]);throw new Error(`[seemly/rgba]: Invalid color value ${t}.`)}catch(n){throw n}}function Oo(t){return t>1?1:t<0?0:t}function Mt(t,n,o,r){return`rgba(${te(t)}, ${te(n)}, ${te(o)}, ${Oo(r)})`}function qe(t,n){const[o,r,a,s=1]=Array.isArray(t)?t:qt(t);return n.alpha?Mt(o,r,a,n.alpha):Mt(o,r,a,s)}function ct(t){const n=Math.round(Number(t)*100)/100;return n>1?1:n<0?0:n}function te(t){const n=Math.round(Number(t));return n>255?255:n<0?0:n}const Lo={list:jt,grid:Ut,image:zt},Mo=()=>{const t=O();return e(mt,{get children(){return[e(ht,{as:Ln,get color(){return fe()},get bgColor(){return qe(fe(),{alpha:.15})},get _hover(){return{bgColor:qe(fe(),{alpha:.2})}},"aria-label":"switch layout",compact:!0,size:"lg",get icon(){return e(Qe,{get children(){return[e(J,{get when(){return at()==="list"},get children(){return e(jt,{})}}),e(J,{get when(){return at()==="grid"},get children(){return e(Ut,{})}}),e(J,{get when(){return at()==="image"},get children(){return e(zt,{})}})]}})}}),e(ft,{get children(){return e(Se,{get each(){return Object.entries(Lo)},children:n=>e(he,{get icon(){return e(Mn,{get component(){return n[1]}})},onSelect:()=>{Tn(n[0])},get children(){return t(`home.layouts.${n[0]}`)}})})}})]}})},To=()=>{const t=Me("logo").split(`
`),n=t[0]==="https://cdn.jsdelivr.net/gh/alist-org/logo@main/logo.svg"?Ve("/images/new_icon.png"):t[0],o=Je(n,t[t.length-1]==="https://cdn.jsdelivr.net/gh/alist-org/logo@main/logo.svg"?Ve("/images/new_icon.png"):t[t.length-1]||n),r=K(()=>{switch(ke.position_of_header_navbar){case"sticky":return{position:"sticky",zIndex:"$sticky",top:0};default:return{position:void 0,zIndex:void 0,top:void 0}}});return e(Ht,Le(r,{bgColor:"$background",class:"header",w:"$full",get children(){return e(Gt,{get children(){return e(W,{px:"calc(2% + 0.5rem)",py:"$2",w:"$full",justifyContent:"space-between",get children(){return[e(W,{class:"header-left",h:"44px",get children(){return e(An,{get src(){return o()},h:"$full",w:"auto",get fallback(){return e(In,{})}})}}),e(W,{class:"header-right",spacing:"$2",get children(){return e(v,{get when(){return E.state===U.Folder},get children(){return[e(v,{get when(){return Me("search_index")!=="none"},get children(){return e(W,{w:"$32",p:"$1",rounded:"$md",justifyContent:"space-between",border:"2px solid transparent",cursor:"pointer",get color(){return fe()},get style(){return{backgroundColor:qe(fe(),{alpha:.15})}},get _hover(){return{style:{backgroundColor:qe(fe(),{alpha:.2})}}},onClick:()=>{m.emit("tool","search")},get children(){return[e(tt,{as:Rn}),e(W,{get children(){return[ne(()=>En?e(st,{children:"Cmd"}):e(st,{children:"Ctrl"})),e(st,{children:"K"})]}})]}})}}),e(Mo,{})]}})}})]}})}})}}))};function Ao(t){return Fn({a:{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},c:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v8a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>'},t)}const ge={rename:{icon:Ur,color:"$accent9"},copy:{icon:zr,color:"$success9"},move:{icon:Hr,color:"$warning9"},delete:{icon:Dn,color:"$danger9"},decompress:{icon:Vr,color:"$primary9"},s3_archive:{icon:Wr,color:"$info9"},s3_restore:{icon:Gr,color:"$warning9"},copy_link:{icon:qr,color:"$info9"},mkdir:{icon:Kr,p:!0},recursive_move:{icon:Pn,p:!0},remove_empty_directory:{icon:Ao,p:!0},batch_rename:{icon:Xr,p:!0},new_file:{icon:Yr,p:!0},cancel_select:{icon:Jr},download:{icon:Nn,color:"$primary9"}},Oe=t=>{const n=Bn.findIndex(r=>r===t.name);if(n!==-1&&!Te.can(Ae(),n))return null;const o=O();return e(pt,{placement:"top",withArrow:!0,get label(){return o(`home.toolbar.${t.name}`)},get children(){return e(tt,Le({get class(){return`toolbar-${t.name}`},get _hover(){return{bgColor:Ye()}},_focus:{outline:"none"},cursor:"pointer",boxSize:"$7",rounded:"$md",get p(){var r;return(r=ge[t.name])!=null&&r.p?"$1_5":"$1"},_active:{transform:"scale(.94)",transition:"0.2s"},get as(){var r;return(r=ge[t.name])==null?void 0:r.icon},get color(){var r;return(r=ge[t.name])==null?void 0:r.color}},t))}})},V=t=>{const n=O();return e(pt,{get disabled(){return!t.tips},placement:"left",withArrow:!0,get label(){return n(`home.toolbar.${t.tips}`)},get children(){return e(tt,Le({get color(){return fe()},get _hover(){return{bgColor:fe(),color:"white"}},_focus:{outline:"none"},cursor:"pointer",boxSize:"$8",rounded:"$lg",p:"$1",_active:{transform:"scale(.94)",transition:"0.2s"},get as(){return t.icon}},t))}})},Io=()=>{const t=O(),{copySelectedPreviewPage:n,copySelectedRawLink:o}=jn(),r="neutral";return e(mt,{placement:"top",offset:10,get children(){return[e(ht,{as:Oe,name:"copy_link"}),e(ft,{get children(){return[e(he,{colorScheme:r,onSelect:()=>{n()},get children(){return t("home.toolbar.preview_page")}}),e(he,{colorScheme:r,onSelect:()=>{o()},get children(){return t("home.toolbar.down_link")}}),e(he,{colorScheme:r,onSelect:()=>{o(!0)},get children(){return t("home.toolbar.encode_down_link")}})]}})]}})},Ro=de("<p></p>"),Eo=()=>{const t=O(),n="neutral",{batchDownloadSelected:o,sendToAria2:r,playlistDownloadSelected:a}=oo();return e(mt,{placement:"top",offset:10,get children(){return[e(ht,{as:Oe,name:"download"}),e(ft,{get children(){return[e(he,{colorScheme:n,onSelect:o,get children(){return t("home.toolbar.batch_download")}}),e(v,{get when(){return Te.is_admin(Ae())||gt("package_download")},get children(){return[e(he,{colorScheme:n,onSelect:()=>{m.emit("tool","package_download")},get children(){return t("home.toolbar.package_download")}}),e(he,{colorScheme:n,onSelect:a,get children(){return t("home.toolbar.playlist_download")}})]}}),e(he,{colorScheme:n,onSelect:r,get children(){return t("home.toolbar.send_aria2")}})]}})]}})},Fo=ve(()=>xe(()=>import("./PackageDownload-8b8471d2.js"),["assets/PackageDownload-8b8471d2.js","assets/index-13b290a7.js","assets/index-b206f97b.css"])),Do=()=>{const t=O(),n=i=>{if(i==="package_download"){if(!gt("package_download"))return;r()}};m.on("tool",n),A(()=>{m.off("tool",n)});const{isOpen:o,onOpen:r,onClose:a}=F(),[s,l]=k("pre_tips");return e(le,{blockScrollOnMount:!1,get opened(){return o()},onClose:a,closeOnOverlayClick:!1,closeOnEsc:!1,get children(){return[e(oe,{}),e(ae,{get children(){return[e(se,{get children(){return t("home.toolbar.package_download")}}),e(Ze,{get fallback(){return e(We,{})},get children(){return e(v,{get when(){return s()==="pre_tips"},get fallback(){return e(Fo,{onClose:a})},get children(){return[e(ie,{get children(){const i=Ro.cloneNode(!0);return re(i,()=>t("home.toolbar.pre_package_download-tips")),i}}),e(me,{display:"flex",gap:"$2",get children(){return[e(D,{onClick:a,colorScheme:"neutral",get children(){return t("global.cancel")}}),e(D,{colorScheme:"info",onClick:()=>{l("package_download")},get children(){return t("global.confirm")}})]}})]}})}})]}})]}})},[Po,{refetch:No}]=Nt(Un),Bo=()=>({labels:Po,refetch:No}),jo=de("<div></div>"),Uo=ve(()=>xe(()=>import("./AddLabelDialog-0c30515a.js"),["assets/AddLabelDialog-0c30515a.js","assets/index-13b290a7.js","assets/index-b206f97b.css"])),zo=ve(()=>xe(()=>import("./EditLabelDialog-e1c497f9.js"),["assets/EditLabelDialog-e1c497f9.js","assets/index-13b290a7.js","assets/index-b206f97b.css"])),Ho=()=>{const t=K(()=>[U.Folder,U.FetchingMore].includes(E.state)&&zn()&&yt()),n=O(),o=K(()=>{if(!Te.is_admin(Ae()))return!1;const h=I();return h.length?h.every(p=>!p.is_dir&&!!p.storage_class):!1}),{labels:r,refetch:a}=Bo(),[s,l]=k(!1),[i,c]=k(!1),{refresh:d}=z();Xe(()=>{const h=()=>{a()};m.on("refresh_labels",h),A(()=>{m.off("refresh_labels",h)})});const g=async(h,p,L)=>{var j;try{const y=I();if(!y.length)return;const M=await a();if((j=M==null?void 0:M.data)!=null&&j.content){const R=M.data.content.find(b=>b.name===h&&b.description===p&&b.bg_color===L);if(R){const b=y.filter(T=>!T.is_dir);if(b.length>0){const T=await Vn(R.id.toString(),b)}await d(!1,!0)}}}catch(y){console.error("Failed to bind label to files:",y)}},u=async h=>{try{const p=I();if(!p.length)return;for(const L of p)L.is_dir;await d(!1,!0)}catch(p){console.error("Failed to update labels for files:",p)}},w=()=>{var p,L;const h=r();(L=(p=h==null?void 0:h.data)==null?void 0:p.content)!=null&&L.length?c(!0):l(!0)};return[e(io,{exitBeforeEnter:!0,get children(){return e(v,{get when(){return t()},get children(){return e(Ce,{class:"center-toolbar",pos:"fixed",bottom:"$4",right:"50%",w:"max-content",color:"$neutral11",get as(){return et.div},initial:{opacity:0,scale:.9,x:"50% ",y:10},animate:{opacity:1,scale:1,x:"50%",y:0},exit:{opacity:0,scale:.9},transition:{duration:.2},get children(){return e(W,{p:"$2",get bgColor(){return Je("white","#000000d0")()},spacing:"$1",shadow:"0px 10px 30px -5px rgba(0, 0, 0, 0.3)",rounded:"$lg",css:{backdropFilter:"blur(8px)"},get children(){return[e(Se,{each:["rename","move","copy","delete","decompress"],children:h=>e(Oe,{name:h,onClick:()=>{m.emit("tool",h)}})}),e(v,{get when(){return o()},get children(){return[e(Oe,{name:"s3_archive",onClick:()=>{m.emit("tool","s3_archive")}}),e(Oe,{name:"s3_restore",onClick:()=>{m.emit("tool","s3_restore")}})]}}),e(v,{get when(){return ne(()=>!!(yt()&&Te.is_admin(Ae())),!0)()&&I().every(h=>!h.is_dir)},get children(){return e(pt,{placement:"top",withArrow:!0,get label(){return n("home.tag.add")},get children(){return e(tt,{class:"toolbar-add_tag",get _hover(){return{bgColor:Ye()}},_focus:{outline:"none"},cursor:"pointer",boxSize:"$7",rounded:"$md",p:"$1",_active:{transform:"scale(.94)",transition:"0.2s"},as:Hn,color:"$info9",onClick:w})}})}}),e(Io,{}),e(Eo,{}),e(Oe,{name:"cancel_select",onClick:()=>{Vt(!1)}})]}})}})}})}}),e(Ze,{get fallback(){return jo.cloneNode(!0)},get children(){return[e(v,{get when(){return s()},get children(){return e(Uo,{get isOpen(){return s()},onClose:()=>l(!1),onSubmit:g})}}),e(v,{get when(){return i()},get children(){return e(zo,{get isOpen(){return i()},onClose:()=>c(!1),onSubmit:u,get labels(){var h,p;return((p=(h=r())==null?void 0:h.data)==null?void 0:p.content)||[]},get obj(){return I()[0]},get isBatch(){return I().length>1},get selectedObjs(){return I()}})}})]}})]},Vo=()=>{const{isOpen:t,onToggle:n}=F({defaultIsOpen:localStorage.getItem("more-open")==="true",onClose:()=>localStorage.setItem("more-open","false"),onOpen:()=>localStorage.setItem("more-open","true")}),o=K(()=>t()?"$4":"$5"),r=K(()=>E.state===U.Folder),{refresh:a}=z();return e(Ce,{class:"left-toolbar-box",pos:"fixed",get right(){return o()},get bottom(){return o()},get children(){return e(v,{get when(){return t()},get fallback(){return e(V,{class:"toolbar-toggle",as:vt,onClick:()=>{n()}})},get children(){return e(ee,{class:"left-toolbar",p:"$1",rounded:"$lg",spacing:"$1",bgColor:"$neutral1",get as(){return et.div},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.6},transition:{duration:.2},get children(){return[e(ee,{spacing:"$1",class:"left-toolbar-in",get children(){return[e(v,{get when(){return ne(()=>!!r(),!0)()&&(kt("write")||E.write)},get children(){return[e(V,{as:to,tips:"refresh",onClick:()=>{a(void 0,!0)}}),e(V,{get as(){return ge.new_file.icon},tips:"new_file",onClick:()=>{m.emit("tool","new_file")}}),e(V,{get as(){return ge.mkdir.icon},p:"$1_5",tips:"mkdir",onClick:()=>{m.emit("tool","mkdir")}}),e(V,{get as(){return ge.recursive_move.icon},tips:"recursive_move",onClick:()=>{m.emit("tool","recursiveMove")}}),e(V,{get as(){return ge.remove_empty_directory.icon},tips:"remove_empty_directory",onClick:()=>{m.emit("tool","removeEmptyDirectory")}}),e(V,{get as(){return ge.batch_rename.icon},tips:"batch_rename",onClick:()=>{Vt(!0),m.emit("tool","batchRename")}}),e(V,{as:Wn,tips:"upload",onClick:()=>{m.emit("tool","upload")}})]}}),e(v,{get when(){return ne(()=>!!r(),!0)()&&kt("offline_download")},get children(){return e(V,{as:Gn,pl:"0",tips:"offline_download",onClick:()=>{m.emit("tool","offline_download")}})}}),e(v,{get when(){return qn()},get children(){return e(V,{as:Zr,tips:"toggle_markdown_toc",onClick:()=>{Kn(s=>!s)}})}}),e(V,{tips:"toggle_checkbox",as:Qr,onClick:Xn}),e(V,{as:Yn,tips:"local_settings",onClick:()=>{m.emit("tool","local_settings")}})]}}),e(V,{tips:"more",as:vt,onClick:n})]}})}})}})},Wo=()=>{const t=O(),{isOpen:n,onOpen:o,onClose:r}=F(),[a,s]=X(Jn),{pathname:l}=P(),{refresh:i}=z(),[c,d]=k(!1),g=u=>{u==="copy"&&(o(),d(!1))};return m.on("tool",g),A(()=>{m.off("tool",g)}),e(nt,{get header(){return t("home.toolbar.choose_dst_folder")},get opened(){return n()},onClose:r,get loading(){return a()},get footerSlot(){return e(Ie,{mr:"auto",get checked(){return c()},onChange:()=>{d(!c())},get children(){return t("home.conflict_policy.overwrite_existing")}})},onSubmit:async u=>{const w=await s(l(),u,I().map(h=>h.name),c());Z(w,()=>{i(),r()})}})},Go=()=>{const t=O(),{isOpen:n,onOpen:o,onClose:r}=F(),[a,s]=X(Zn),{pathname:l}=P(),{refresh:i}=z(),[c,d]=k(!1),g=u=>{u==="move"&&(o(),d(!1))};return m.on("tool",g),A(()=>{m.off("tool",g)}),e(nt,{get header(){return t("home.toolbar.choose_dst_folder")},get opened(){return n()},onClose:r,get loading(){return a()},get footerSlot(){return e(Ie,{mr:"auto",get checked(){return c()},onChange:()=>{d(!c())},get children(){return t("home.conflict_policy.overwrite_existing")}})},onSubmit:async u=>{const w=await s(l(),u,I().map(h=>h.name),c());Z(w,()=>{i(),r()})}})},qo=de("<p></p>"),Ko=()=>{const t=O(),{isOpen:n,onOpen:o,onClose:r}=F(),[a,s]=X(Qn),{refresh:l}=z(),{pathname:i}=P(),c=d=>{d==="delete"&&o()};return m.on("tool",c),A(()=>{m.off("tool",c)}),e(le,{blockScrollOnMount:!1,get opened(){return n()},onClose:r,size:{"@initial":"xs","@md":"md"},get children(){return[e(oe,{}),e(ae,{get children(){return[e(se,{get children(){return t("home.toolbar.delete")}}),e(ie,{get children(){const d=qo.cloneNode(!0);return re(d,()=>t("home.toolbar.delete-tips")),d}}),e(me,{display:"flex",gap:"$2",get children(){return[e(D,{onClick:r,colorScheme:"neutral",get children(){return t("global.cancel")}}),e(D,{colorScheme:"danger",get loading(){return a()},onClick:async()=>{const d=await s(i(),I().map(g=>g.name));Z(d,()=>{l(),r()})},get children(){return t("global.confirm")}})]}})]}})]}})},Xo=()=>{const t=O(),{isOpen:n,onOpen:o,onClose:r}=F(),[a,s]=X(er),{pathname:l}=P(),{refresh:i}=z(),[c,d]=k(!1),g=u=>{if(u==="rename"){if(!tr()){m.emit("tool","batchRename");return}o(),d(!1)}};return m.on("tool",g),A(()=>{m.off("tool",g)}),e(v,{get when(){return n()},get children(){return e(rt,{title:"home.toolbar.input_new_name",get footerSlot(){return e(Ie,{mr:"auto",get checked(){return c()},onChange:()=>{d(!c())},get children(){return t("home.conflict_policy.overwrite_existing")}})},get isRenamingFile(){return!I()[0].is_dir},get opened(){return n()},onClose:r,get defaultValue(){var u;return((u=I()[0])==null?void 0:u.name)??""},get loading(){return a()},onSubmit:async u=>{const w=await s(Q(l(),I()[0].name),u,c());Z(w,()=>{i(),r()})}})}})},Yo=()=>{const t=O(),{isOpen:n,onOpen:o,onClose:r}=F(),[a,s]=X(nr),{refresh:l}=z(),{pathname:i}=P(),[c,d]=k(!1),g=u=>{u==="new_file"&&(o(),d(!1))};return m.on("tool",g),A(()=>{m.off("tool",g)}),e(rt,{title:"home.toolbar.input_filename",get footerSlot(){return e(Ie,{mr:"auto",get checked(){return c()},onChange:()=>{d(!c())},get children(){return t("home.conflict_policy.overwrite_existing")}})},get opened(){return n()},onClose:r,get loading(){return a()},onSubmit:async u=>{const w=await s(Q(i(),u),Ke(),c());Z(w,()=>{l(),r()})}})},Jo=()=>{const{isOpen:t,onOpen:n,onClose:o}=F(),[r,a]=X(rr),{pathname:s}=P(),{refresh:l}=z(),i=c=>{c==="mkdir"&&n()};return m.on("tool",i),A(()=>{m.off("tool",i)}),e(rt,{title:"home.toolbar.input_dir_name",get opened(){return t()},onClose:o,get loading(){return r()},onSubmit:async c=>{const d=await a(Q(s(),c));Z(d,()=>{l(),o()})}})},Zo=de("<p></p>"),Qo=()=>{const{isOpen:t,onOpen:n,onClose:o}=F(),{isOpen:r,onOpen:a,onClose:s}=F(),[l,i]=X(or),{pathname:c}=P(),{refresh:d}=z(),[g,u]=k("cancel"),w=p=>{p==="recursiveMove"&&(n(),u("cancel"))};m.on("tool",w),A(()=>{m.off("tool",w)});const h=O();return[e(le,{blockScrollOnMount:!1,get opened(){return t()},onClose:()=>o(),size:{"@initial":"xs","@md":"md"},get children(){return[e(oe,{}),e(ae,{get children(){return[e(se,{get children(){return h("home.toolbar.recursive_move")}}),e(ie,{get children(){const p=Zo.cloneNode(!0);return re(p,()=>h("home.toolbar.recursive_move_directory-tips")),p}}),e(me,{display:"flex",gap:"$2",get children(){return[e(D,{onClick:()=>o(),colorScheme:"neutral",get children(){return h("global.cancel")}}),e(D,{onClick:()=>{o(),a()},colorScheme:"danger",get children(){return h("global.confirm")}})]}})]}})]}}),e(nt,{get header(){return h("home.toolbar.choose_dst_folder")},get opened(){return r()},onClose:s,get loading(){return l()},get footerSlot(){return e(W,{mr:"auto",flex:"0.8",spacing:"$1",get children(){return e(ar,{get value(){return g()},onChange:p=>u(p),get children(){return[e(it,{value:"cancel",get children(){return h("home.conflict_policy.cancel_if_exists")}}),e(it,{value:"overwrite",get children(){return h("home.conflict_policy.overwrite_existing")}}),e(it,{value:"skip",get children(){return h("home.conflict_policy.skip_existing")}})]}})}})},onSubmit:async p=>{const L=await i(c(),p,g());Z(L,()=>{d(),s()})}})]},ea=de("<p></p>"),ta=()=>{const{isOpen:t,onOpen:n,onClose:o}=F(),{pathname:r}=P(),[a,s]=X(sr),{refresh:l}=z(),i=d=>{d==="removeEmptyDirectory"&&n()};m.on("tool",i),A(()=>{m.off("tool",i)});const c=O();return e(le,{blockScrollOnMount:!1,get opened(){return t()},onClose:o,size:{"@initial":"xs","@md":"md"},get children(){return[e(oe,{}),e(ae,{get children(){return[e(se,{get children(){return c("home.toolbar.remove_empty_directory")}}),e(ie,{get children(){const d=ea.cloneNode(!0);return re(d,()=>c("home.toolbar.remove_empty_directory-tips")),d}}),e(me,{display:"flex",gap:"$2",get children(){return[e(D,{onClick:o,colorScheme:"neutral",get children(){return c("global.cancel")}}),e(D,{colorScheme:"danger",get loading(){return a()},onClick:async()=>{const d=await s(r());Z(d,()=>{l(),o()})},get children(){return c("global.confirm")}})]}})]}})]}})},na=t=>e(et.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},style:{width:"100%"},get children(){return e(W,{class:"list-item",w:"$full",p:"$2",rounded:"$lg",transition:"all 0.3s",get _hover(){return{transform:"scale(1.01)",bgColor:Ye()}},get children(){return[e(ce,{w:{"@initial":"50%","@md":"50%"},class:"name",css:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},get title(){return t.obj.src_name},get children(){return t.obj.src_name}}),e(ce,{w:{"@initial":"50%","@md":"50%"},class:"name",css:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},get title(){return t.obj.new_name},get children(){return t.obj.new_name}})]}})}}),ra=de("<p></p>"),oa=()=>{const{isOpen:t,onOpen:n,onClose:o}=F(),{isOpen:r,onOpen:a,onClose:s}=F(),[l,i]=X(ir),{pathname:c}=P(),{refresh:d}=z(),[g,u]=k("1"),[w,h]=k(""),[p,L]=k(""),[j,y]=k("string"),[M,R]=k([]),b=O(),T=()=>({fontWeight:"bold",fontSize:"$sm",color:"$neutral11",textAlign:"left",cursor:"pointer"}),G=x=>{x==="batchRename"&&a()};m.on("tool",G),A(()=>{m.off("tool",G)});const pe=()=>{if(!w()||!p()){B.warning(b("global.empty_input"));return}const x=new RegExp(w(),"g");let be;if(g()==="1")be=I().filter(_=>_.name.match(w())).map(_=>{const $=new Date(_.created),S=new Date(_.modified);return{src_name:_.name,new_name:_.name.replace(x,p()).replace("{created_year}",$.getFullYear().toString().padStart(4,"0")).replace("{created_month}",($.getMonth()+1).toString().padStart(2,"0")).replace("{created_date}",$.getDate().toString().padStart(2,"0")).replace("{created_hour}",$.getHours().toString().padStart(2,"0")).replace("{created_minute}",$.getMinutes().toString().padStart(2,"0")).replace("{created_second}",$.getSeconds().toString().padStart(2,"0")).replace("{modified_year}",S.getFullYear().toString().padStart(4,"0")).replace("{modified_month}",(S.getMonth()+1).toString().padStart(2,"0")).replace("{modified_date}",S.getDate().toString().padStart(2,"0")).replace("{modified_hour}",S.getHours().toString().padStart(2,"0")).replace("{modified_minute}",S.getMinutes().toString().padStart(2,"0")).replace("{modified_second}",S.getSeconds().toString().padStart(2,"0"))}});else{let _=p();be=I().map($=>{let S="";const q=$.name.lastIndexOf(".");q!==-1&&(S=$.name.substring(q+1));const Fe={src_name:$.name,new_name:w()+_+"."+S};return _=(parseInt(_)+1).toString().padStart(_.length,"0"),Fe})}R(be),n(),s()};return[e(le,{blockScrollOnMount:!1,get opened(){return r()},onClose:s,initialFocus:"#modal-input1",size:{"@initial":"xs","@md":"md"},get children(){return[e(oe,{}),e(ae,{get children(){return[e(se,{get children(){return b("home.toolbar.batch_rename")}}),e(ie,{get children(){return[e(lr,{defaultValue:"1",onChange:x=>{u(x),x==="1"?y("string"):x==="2"&&y("number")},get children(){return e(W,{spacing:"$4",get children(){return[e($t,{value:"1",get children(){return b("home.toolbar.regex_rename")}}),e($t,{value:"2",get children(){return b("home.toolbar.sequential_renaming")}})]}})}}),e(ee,{spacing:"$2",get children(){return[(()=>{const x=ra.cloneNode(!0);return x.style.setProperty("margin","10px 0"),re(x,e(v,{get when(){return g()==="1"},get children(){return b("home.toolbar.regular_rename")}}),null),re(x,e(v,{get when(){return g()==="2"},get children(){return b("home.toolbar.sequential_renaming_desc")}}),null),x})(),e($e,{id:"modal-input1",type:"string",get value(){return w()},onInput:x=>{h(x.currentTarget.value)},onKeyDown:x=>{x.key==="Enter"&&pe()}}),e($e,{id:"modal-input2",get type(){return j()},get value(){return p()},onInput:x=>{L(x.currentTarget.value)},onKeyDown:x=>{x.key==="Enter"&&pe()}})]}})]}}),e(me,{display:"flex",gap:"$2",get children(){return[e(D,{onClick:()=>{u("1"),y("string"),s()},colorScheme:"neutral",get children(){return b("global.cancel")}}),e(D,{onClick:()=>pe(),get disabled(){return!w()||!p()},get children(){return b("global.ok")}})]}})]}})]}}),e(le,{size:"xl",get opened(){return t()},onClose:o,get children(){return[e(oe,{}),e(ae,{get children(){return[e(se,{get children(){return b("home.toolbar.regex_rename_preview")}}),e(ie,{get children(){return e(ee,{class:"list",w:"$full",spacing:"$1",get children(){return[e(W,{class:"title",w:"$full",p:"$2",get children(){return[e(ce,Le({w:{"@initial":"50%","@md":"50%"}},T,{get children(){return b("home.toolbar.regex_rename_preview_old_name")}})),e(ce,Le({w:{"@initial":"50%","@md":"50%"}},T,{get children(){return b("home.toolbar.regex_rename_preview_new_name")}}))]}}),e(Se,{get each(){return M()},children:(x,be)=>e(na,{obj:x,get index(){return be()}})})]}})}}),e(me,{display:"flex",gap:"$2",get children(){return[e(D,{onClick:()=>{R([]),u("1"),y("string"),o(),s()},colorScheme:"neutral",get children(){return b("global.cancel")}}),e(D,{onClick:()=>{R([]),o(),a()},colorScheme:"neutral",get children(){return b("global.back")}}),e(D,{get loading(){return l()},onClick:async()=>{const x=await i(c(),M());Z(x,()=>{R([]),h(""),L(""),u("1"),y("string"),d(),s(),o()})},get disabled(){return M().length==0},get children(){return b("global.ok")}})]}})]}})]}})]};/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wärting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const Tt="0123456789abcdef",Kt=[];for(let t=0;t<256;t++)Kt[t]=Tt[t>>4&15]+Tt[t&15];const aa=t=>{const n=t.length;let o="",r=0;for(;r<n;)o+=Kt[t[r++]];return o},sa=(t,n=0)=>{const o=t.length||0;if(!n){let l=o;for(;l--;)n+=t[l].length}const r=new Uint8Array(n);let a=n,s=o;for(;s--;)a-=t[s].length,r.set(t[s],a);return r};var At="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ia=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var ze=0;ze<At.length;ze++)ia[At.charCodeAt(ze)]=ze;const la=new TextDecoder,Xt=(t,n)=>n?new TextDecoder(n).decode(t):la.decode(t),ca=new TextEncoder,ue=t=>ca.encode(t),It=typeof window<"u"?window:self,Rt=It.crypto||It.msCrypto||{};Rt.subtle||Rt.webkitSubtle;function je(t){const n=t<0?1:0;return t=Math.abs(Number(t||1)),Math.floor(Math.log10(t))+1+n}function Yt(t){return ArrayBuffer.isView(t)?"arraybufferview":Array.isArray(t)?"array":t instanceof Number?"number":t instanceof Boolean?"boolean":t instanceof Set?"set":t instanceof Map?"map":t instanceof String?"string":t instanceof ArrayBuffer?"arraybuffer":typeof t}function C(t,n,o){const r=[];let a=null;return C._encode(r,t),a=sa(r),C.bytes=a.length,ArrayBuffer.isView(n)?(n.set(a,o),n):a}C.bytes=-1;C._floatConversionDetected=!1;C._encode=function(t,n){if(n!=null)switch(Yt(n)){case"object":C.dict(t,n);break;case"map":C.dictMap(t,n);break;case"array":C.list(t,n);break;case"set":C.listSet(t,n);break;case"string":C.string(t,n);break;case"number":C.number(t,n);break;case"boolean":C.number(t,n);break;case"arraybufferview":C.buffer(t,new Uint8Array(n.buffer,n.byteOffset,n.byteLength));break;case"arraybuffer":C.buffer(t,new Uint8Array(n));break}};const ot=new Uint8Array([101]),Jt=new Uint8Array([100]),Zt=new Uint8Array([108]);C.buffer=function(t,n){t.push(ue(n.length+":"),n)};C.string=function(t,n){t.push(ue(ue(n).byteLength+":"+n))};C.number=function(t,n){if(Number.isInteger(n))return t.push(ue("i"+BigInt(n)+"e"));const o=2147483648,r=n/o<<0,a=n%o<<0,s=r*o+a;t.push(ue("i"+s+"e")),s!==n&&!C._floatConversionDetected&&(C._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+n+'":','Bencoding only defines support for integers, value was converted to "'+s+'"'),console.trace())};C.dict=function(t,n){t.push(Jt);let o=0,r;const a=Object.keys(n).sort(),s=a.length;for(;o<s;o++)r=a[o],n[r]!=null&&(C.string(t,r),C._encode(t,n[r]));t.push(ot)};C.dictMap=function(t,n){t.push(Jt);const o=Array.from(n.keys()).sort();for(const r of o)n.get(r)!=null&&(ArrayBuffer.isView(r)?C._encode(t,r):C.string(t,String(r)),C._encode(t,n.get(r)));t.push(ot)};C.list=function(t,n){let o=0;const r=n.length;for(t.push(Zt);o<r;o++)n[o]!=null&&C._encode(t,n[o]);t.push(ot)};C.listSet=function(t,n){t.push(Zt);for(const o of n)o!=null&&C._encode(t,o);t.push(ot)};const ua=105,da=58,ga=100,ha=108,bt=101;function Qt(t,n,o){let r=0,a=1;for(let s=n;s<o;s++){const l=t[s];if(l<58&&l>=48){r=r*10+(l-48);continue}if(!(s===n&&l===43)){if(s===n&&l===45){a=-1;continue}if(l===46)break;throw new Error("not a number: buffer["+s+"] = "+l)}}return r*a}function f(t,n,o,r){return t==null||t.length===0?null:(typeof n!="number"&&r==null&&(r=n,n=void 0),typeof o!="number"&&r==null&&(r=o,o=void 0),f.position=0,f.encoding=r||null,f.data=ArrayBuffer.isView(t)?new Uint8Array(t.slice(n,o)):ue(t),f.bytes=f.data.length,f.next())}f.bytes=0;f.position=0;f.data=null;f.encoding=null;f.next=function(){switch(f.data[f.position]){case ga:return f.dictionary();case ha:return f.list();case ua:return f.integer();default:return f.buffer()}};f.find=function(t){let n=f.position;const o=f.data.length,r=f.data;for(;n<o;){if(r[n]===t)return n;n++}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(t)+'" [0x'+t.toString(16)+"]")};f.dictionary=function(){f.position++;const t={};for(;f.data[f.position]!==bt;){const n=f.buffer();let o=Xt(n);o.includes("�")&&(o=aa(n)),t[o]=f.next()}return f.position++,t};f.list=function(){f.position++;const t=[];for(;f.data[f.position]!==bt;)t.push(f.next());return f.position++,t};f.integer=function(){const t=f.find(bt),n=Qt(f.data,f.position+1,t);return f.position+=t+1-f.position,n};f.buffer=function(){let t=f.find(da);const n=Qt(f.data,f.position,t),o=++t+n;return f.position=o,f.encoding?Xt(f.data.slice(t,o)):f.data.slice(t,o)};function fa(t){let n=2;for(const o of t)n+=Ue(o);return n}function ma(t){let n=2;for(const[o,r]of t){const a=ue(o).byteLength;n+=je(a)+1+a,n+=Ue(r)}return n}function pa(t){let n=2;const o=Object.keys(t);for(let r=0;r<o.length;r++){const a=ue(o[r]).byteLength;n+=je(a)+1+a,n+=Ue(t[o[r]])}return n}function ba(t){const n=ue(t).byteLength;return je(n)+1+n}function _a(t){const n=t.byteLength-t.byteOffset;return je(n)+1+n}function Ue(t){if(t==null)return 0;const o=Yt(t);switch(o){case"arraybufferview":return _a(t);case"string":return ba(t);case"array":case"set":return fa(t);case"number":return 1+je(Math.floor(t))+1;case"bigint":return 1+t.toString().length+1;case"object":return pa(t);case"map":return ma(t);default:throw new TypeError(`Unsupported value of type "${o}"`)}}const wa=Ue,Et={encode:C,decode:f,byteLength:Ue,encodingLength:wa},ya=["delete_on_upload_succeed","delete_on_upload_failed","delete_never","delete_always"];function Ft(t){return Ge.enc.Utf8.stringify(Ge.lib.WordArray.create(t))}function ka(t){var s;const n=Et.decode(t),o=Et.encode(n.info),r=Ge.SHA1(Ge.lib.WordArray.create(o)).toString();let a={};return Number.isInteger((s=n==null?void 0:n.info)==null?void 0:s.length)&&(a.xl=n.info.length),n.info.name&&(a.dn=Ft(n.info.name)),n.announce&&(a.tr=Ft(n.announce)),`magnet:?xt=urn:btih:${r}&${new URLSearchParams(a).toString()}`}const $a=()=>{const t=O(),[n,o]=k([]),[r,a]=X(()=>cr.get("/public/offline_download_tools")),[s,l]=k(""),[i,c]=k("delete_on_upload_succeed");Xe(async()=>{const y=await a();ur(y,M=>{o(M),l(M[0])})});const{isOpen:d,onOpen:g,onClose:u}=F(),[w,h]=X(dr),{pathname:p}=P(),L=y=>{y==="offline_download"&&g()};return m.on("tool",L),A(()=>{m.off("tool",L)}),e(rt,{title:"home.toolbar.offline_download",type:"text",get opened(){return d()},onClose:u,get loading(){return r()||w()},get tips(){return t("home.toolbar.offline_download-tips")},onDrop:async(y,M)=>{var R;if(y.preventDefault(),(R=y.dataTransfer)!=null&&R.files.length){const b=[];for(const T of y.dataTransfer.files)if(T.name.toLowerCase().endsWith(".torrent"))try{const G=await T.arrayBuffer();b.push(ka(new Uint8Array(G)))}catch(G){console.error("Failed to convert torrent file to magnet link:",G)}b.length&&M(b.join(`
`))}},get topSlot(){return e(Ce,{mb:"$2",get children(){return e(Ct,{get value(){return s()},onChange:y=>l(y),get options(){return n().map(y=>({value:y,label:y}))}})}})},get bottomSlot(){return e(Ce,{mb:"$2",get children(){return e(Ct,{get value(){return i()},onChange:y=>c(y),get options(){return ya.map(y=>({value:y,label:t(`home.toolbar.delete_policy.${y}`)}))}})}})},onSubmit:async y=>{const M=await h(p(),y.split(`
`),s(),i());Z(M,()=>{u()})}})},Ca=t=>{const n=O(),o=l=>{l===t.name&&a()};m.on("tool",o),A(()=>{m.off("tool",o)});const{isOpen:r,onOpen:a,onClose:s}=F();return e(le,{get blockScrollOnMount(){return t.blockScrollOnMount},get opened(){return r()},onClose:s,closeOnOverlayClick:!1,closeOnEsc:!1,size:{"@initial":"xs","@md":"md","@lg":"lg","@xl":"xl","@2xl":"2xl"},get children(){return[e(oe,{}),e(ae,{get children(){return[e(Wt,{}),e(se,{get children(){return n(t.title)}}),e(ie,{get children(){return e(v,{get when(){return r()},get children(){return e(Ze,{get fallback(){return e(We,{})},get children(){return t.children}})}})}})]}})]}})};function Sa(t){const n=O();return e(Pe,{get children(){return[e(De,{get children(){return n(`home.local_settings.${t.key}`)}}),e(Qe,{get fallback(){return e($e,{get value(){return ke[t.key]},onInput:o=>{lt(t.key,o.currentTarget.value)}})},get children(){return[e(J,{get when(){return t.type==="select"},get children(){return e(dt,{get id(){return t.key},get defaultValue(){return ke[t.key]},onChange:o=>lt(t.key,o),get children(){return[e(kr,{get children(){return[e($r,{get children(){return n("global.choose")}}),e(Cr,{}),e(Sr,{})]}}),e(vr,{get children(){return e(xr,{get children(){return e(Se,{get each(){return ne(()=>typeof t.options=="function",!0)()?t.options():t.options},children:o=>e(Or,{value:o,get children(){return[e(Lr,{get children(){return n(`home.local_settings.${t.key}_options.${o}`)}}),e(Mr,{})]}})})}})}})]}})}}),e(J,{get when(){return t.type==="boolean"},get children(){return e(Tr,{get defaultChecked(){return ke[t.key]==="true"},onChange:o=>{lt(t.key,o.currentTarget.checked.toString())}})}})]}})]}})}const va=()=>{const{isOpen:t,onOpen:n,onClose:o}=F(),r=O(),a=s=>{s==="local_settings"&&n()};return m.on("tool",a),A(()=>{m.off("tool",a)}),e(yr,{get opened(){return t()},placement:"right",onClose:o,get children(){return[e(gr,{}),e(hr,{get children(){return[e(fr,{}),e(mr,{color:"$info9",get children(){return r("home.toolbar.local_settings")}}),e(pr,{get children(){return[e(ee,{spacing:"$2",get children(){return e(Se,{get each(){return br.filter(s=>!s.hidden)},children:s=>e(Sa,s)})}}),e(Ht,{mt:"$4",get children(){return e(W,{spacing:"$4",p:"$2",color:"$neutral11",get children(){return[e(_r,{}),e(wr,{})]}})}})]}})]}})]}})},xa=de("<div></div>"),Oa=()=>{const t=O(),{isOpen:n,onOpen:o,onClose:r}=F(),[a,s]=X(Ar),{pathname:l}=P(),{refresh:i}=z(),[c,d]=k(""),[g,u]=k(""),[w,h]=k(!0),[p,L]=k(!1),j=b=>{b==="decompress"&&(ut(()=>{h(!0),d("/"),u("")}),o())},y=b=>{const{inner:T,pass:G}=JSON.parse(b);ut(()=>{h(!1),d(T),u(G)}),o()};m.on("tool",j),m.on("extract",y),A(()=>{m.off("tool",j),m.off("extract",y)});const M=()=>c()==="/"?t("home.toolbar.choose_dst_folder"):t("home.toolbar.archive.extract_header",{path:c()}),R=()=>{let b=l();if(c()==="/")return{path:b,name:I().map(T=>T.name)};{let T=b.lastIndexOf("/");return{path:b.slice(0,T),name:[b.slice(T+1)]}}};return e(nt,{get header(){return M()},get opened(){return n()},onClose:r,get loading(){return a()},onSubmit:async b=>{const{path:T,name:G}=R(),pe=await s(T,b,G,g(),c(),w(),p());Z(pe,()=>{i(),r()})},get children(){return e(ee,{spacing:"$1",alignItems:"flex-start",get children(){return[e(W,{width:"100%",spacing:"$1",get children(){return[e(ce,{size:"sm",css:{whiteSpace:"nowrap"},get children(){return t("home.toolbar.decompress-pass")}}),e($e,{get value(){return g()},onInput:b=>u(b.target.value),size:"sm",flexGrow:"1"})]}}),e(Ie,{get checked(){return w()},onChange:b=>h(b.target.checked),get children(){return t("home.toolbar.decompress-cache-full")}}),e(Ie,{get checked(){return p()},onChange:b=>L(b.target.checked),get children(){return t("home.toolbar.decompress-put-into-new")}}),xa.cloneNode(!0)]}})}})},La=de('<div><span></span><span></span><a target="_blank" rel="noreferrer"></a></div>'),Ma=["GLACIER","DEEP_ARCHIVE","GLACIER_IR","STANDARD_IA","ONEZONE_IA","INTELLIGENT_TIERING","STANDARD"],Ta=["Standard","Bulk","Expedited"],Aa=()=>{const{isOpen:t,onOpen:n,onClose:o}=F(),r=O(),{pathname:a}=P(),{refresh:s}=z(),[l,i]=k("s3_archive"),[c,d]=k([]),[g,u]=k("GLACIER"),[w,h]=k(""),[p,L]=k("7"),[j,y]=k("Standard"),[M,R]=k(!1),b=_=>{if(_!=="s3_archive"&&_!=="s3_restore")return;const $=I().filter(S=>!S.is_dir&&!!S.storage_class);$.length&&(d($.map(S=>({...S}))),i(_),_==="s3_archive"?(u("GLACIER"),h("")):(L("7"),y("Standard")),n())};m.on("tool",b),A(()=>{m.off("tool",b)});const T=()=>{M()||(d([]),o())},G=()=>Ma.map(_=>{const $=xt(_),S=$?r(`home.storage_class.${$}`):void 0;return{key:_,label:S||_}}),pe=()=>Ta.map(_=>({key:_,label:r(`home.toolbar.s3_transition.tier.${_.toLowerCase()}`)})),x=_=>{const $=Q("/",a()),S=Q($,_.name);if(_.path){const q=Q("/",_.path);return q===S?q:S.endsWith(q)?S:q}return S},be=async()=>{var _;if(c().length){R(!0);try{let $;if(l()==="s3_archive"){const N={action:"archive",storage_class:g()},Y=w().trim()?Number(w()):void 0;if(Y!==void 0){if(Number.isNaN(Y)||Y<0){B.error(r("home.toolbar.s3_transition.invalid_transition_days")),R(!1);return}N.days=Math.floor(Y)}$=N}else{const N=Number(p());if(Number.isNaN(N)||N<=0){B.error(r("home.toolbar.s3_transition.invalid_restore_days")),R(!1);return}$={action:"restore",days:Math.floor(N),tier:j()}}const S=[];for(const N of c()){const Y=await Ir(x(N),$,Ke());if(Y.code!==200){B.error(Y.message),R(!1);return}S.push((_=Y.data)==null?void 0:_.task_id)}const q=l()==="s3_archive"?"home.toolbar.s3_transition.archive_success":"home.toolbar.s3_transition.restore_success";B.success(r(q,{count:c().length}));const Fe=S.filter(N=>!!N);Fe.length&&B.render((()=>{const N=La.cloneNode(!0),Y=N.firstChild,_t=Y.nextSibling,wt=_t.nextSibling;return N.style.setProperty("display","flex"),N.style.setProperty("flex-direction","column"),N.style.setProperty("gap","4px"),re(Y,()=>r("home.toolbar.s3_transition.task_created",{count:Fe.length})),re(_t,()=>r("home.toolbar.s3_transition.task_ids",{ids:Fe.join(", ")})),re(wt,()=>r("home.toolbar.s3_transition.task_link")),Rr(()=>Er(wt,"href",Ve("/@manage/tasks"))),N})()),await s(!1,!0),d([]),o()}catch($){console.error($),B.error(($==null?void 0:$.message)??String($))}finally{R(!1)}}};return e(le,{blockScrollOnMount:!1,get opened(){return t()},onClose:T,size:{"@initial":"xs","@md":"md"},get children(){return[e(oe,{}),e(ae,{get children(){return[e(Wt,{get disabled(){return M()}}),e(se,{get children(){return ne(()=>l()==="s3_archive",!0)()?r("home.toolbar.s3_transition.title_archive"):r("home.toolbar.s3_transition.title_restore")}}),e(ie,{get children(){return e(ee,{alignItems:"start",spacing:"$2",get children(){return[e(ce,{get children(){return r("home.toolbar.s3_transition.selection",{count:c().length})}}),e(Se,{get each(){return c()},children:_=>e(ce,{fontSize:"$sm",get children(){return[ne(()=>_.name),e(v,{get when(){return _.storage_class},children:$=>{const S=xt($),q=S&&S.length>0?r(`home.storage_class.${S}`):void 0;return[" ","—",ne(()=>r("home.toolbar.s3_transition.current_class",{value:q||$}))]}})]}})}),e(v,{get when(){return l()==="s3_archive"},get children(){return[e(Pe,{get children(){return[e(De,{get children(){return r("home.toolbar.s3_transition.storage_class")}}),e(dt,{get value(){return g()},onChange:_=>u(_),get children(){return e(St,{get options(){return G()}})}})]}}),e(Pe,{get children(){return[e(De,{get children(){return r("home.toolbar.s3_transition.transition_days")}}),e($e,{type:"number",min:"0",get value(){return w()},onInput:_=>h(_.currentTarget.value),get placeholder(){return r("home.toolbar.s3_transition.transition_days_hint")}})]}})]}}),e(v,{get when(){return l()==="s3_restore"},get children(){return[e(Pe,{get children(){return[e(De,{get children(){return r("home.toolbar.s3_transition.restore_days")}}),e($e,{type:"number",min:"1",get value(){return p()},onInput:_=>L(_.currentTarget.value)})]}}),e(Pe,{get children(){return[e(De,{get children(){return r("home.toolbar.s3_transition.restore_tier")}}),e(dt,{get value(){return j()},onChange:_=>y(_),get children(){return e(St,{get options(){return pe()}})}})]}})]}})]}})}}),e(me,{display:"flex",gap:"$2",get children(){return[e(D,{onClick:T,colorScheme:"neutral",get disabled(){return M()},get children(){return r("global.cancel")}}),e(D,{colorScheme:"accent",get loading(){return M()},onClick:()=>be(),get children(){return r("global.confirm")}})]}})]}})]}})},Ia=ve(()=>xe(()=>import("./Upload-2acc2769.js"),["assets/Upload-2acc2769.js","assets/index-13b290a7.js","assets/index-b206f97b.css","assets/index-69644529.js"])),Ra=()=>[e(Wo,{}),e(Go,{}),e(Xo,{}),e(Ko,{}),e(Oa,{}),e(Aa,{}),e(Yo,{}),e(Jo,{}),e(Qo,{}),e(ta,{}),e(oa,{}),e($a,{}),e(Do,{}),e(Ca,{name:"upload",title:"home.toolbar.upload",get children(){return e(Ia,{})}}),e(va,{})],Ea=()=>e(Dr,{get children(){return[e(Vo,{}),e(Ho,{}),e(Ra,{}),e(Fr,{})]}}),Fa=()=>{Nr(Me("site_title"));const t=Me("announcement");return t&&B.render(()=>e(Bt,{children:t})),[e(To,{}),e(Ea,{}),e(_o,{}),e(yo,{})]},Ha=Object.freeze(Object.defineProperty({__proto__:null,default:Fa},Symbol.toStringTag,{value:"Module"}));export{Ha as L,Bo as a,ge as o,oo as u};
