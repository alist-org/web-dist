import{b as _,d as v,bb as S,bs as h,B as k,dG as b,x as e,av as m,Q as l,ao as B,dq as U,dr as x,ds as $,W as f,dt as w,du as F,dv as o,bt as i,n as T,ai as L,cO as W,dE as D}from"./index-57fea832.js";import{b as H}from"./useTitle-c73d6af6.js";import{D as I}from"./DeletePopover-47e1e907.js";import{W as O}from"./Wether-df0c81ec.js";const q=r=>{const[c,d]=k([]);(async()=>{const s=await D();i(s,n=>{d(n.content)})})();const u=s=>{switch(s){case 1:return"neutral";case 2:return"success";default:return"info"}};return e(m,{spacing:"$1",get children(){return e(f,{get each(){return r.role},children:s=>e(W,{get colorScheme(){return u(s)},get children(){var n;return(n=c().find(g=>g.id===s))==null?void 0:n.name}})})}})},Q=()=>{const r=_();H("manage.sidemenu.users");const{to:c}=v(),[d,p]=S(()=>h.get("/admin/user/list")),[u,s]=k([]),n=async()=>{const t=await p();i(t,a=>s(a.content))};n();const[g,y]=b(t=>h.post(`/admin/user/delete?id=${t}`)),[C,R]=b(t=>h.post(`/admin/user/cancel_2fa?id=${t}`));return e(L,{spacing:"$2",alignItems:"start",w:"$full",get children(){return[e(m,{spacing:"$2",get children(){return[e(l,{colorScheme:"accent",get loading(){return d()},onClick:n,get children(){return r("global.refresh")}}),e(l,{onClick:()=>{c("/@manage/users/add")},get children(){return r("global.add")}})]}}),e(B,{w:"$full",overflowX:"auto",get children(){return e(U,{highlightOnHover:!0,dense:!0,get children(){return[e(x,{get children(){return e($,{get children(){return[e(f,{each:["username","role","available"],children:t=>e(w,{get children(){return r(`users.${t}`)}})}),e(w,{get children(){return r("global.operations")}})]}})}}),e(F,{get children(){return e(f,{get each(){return u()},children:t=>e($,{get children(){return[e(o,{get children(){return t.username}}),e(o,{get children(){return e(q,{get role(){return t.role}})}}),e(o,{get children(){return e(O,{get yes(){return!t.disabled}})}}),e(o,{get children(){return e(m,{spacing:"$2",get children(){return[e(l,{onClick:()=>{c(`/@manage/users/edit/${t.id}`)},get children(){return r("global.edit")}}),e(I,{get name(){return t.username},get loading(){return g()===t.id},onClick:async()=>{const a=await y(t.id);i(a,()=>{T.success(r("global.delete_success")),n()})}}),e(l,{colorScheme:"accent",get loading(){return C()===t.id},onClick:async()=>{const a=await R(t.id);i(a,()=>{T.success(r("users.cancel_2fa_success")),n()})},get children(){return r("users.cancel_2fa")}})]}})}})]}})})}})]}})}})]}})};export{Q as default};
