import{dO as V,U as O,d as J,b as _,A as v,x as t,ai as E,$ as L,am as f,av as b,ej as p,E as B,S as m,b2 as D,aP as Y,aC as K,da as Z,d2 as M,aO as q,ah as g,b0 as x,q as Q,r as ee,b_ as te,cd as ne,cX as k,W as C,aZ as re,ao as ie,cY as H,dc as ae,au as oe,az as z,o as le,ay as se,j as ce,e as de,B as A,H as ue,ek as ge,el as he,b5 as fe,V as S,em as be,ad as we}from"./index-6ba85c96.js";import{b as pe}from"./style-2d591408.js";import{n as xe}from"./storage-class-1ac53f89.js";import{u as ye}from"./index-b8fadc74.js";import{I as U,u as F}from"./helper-9877ccec.js";import{g as T}from"./color-a58de010.js";const $e=z("<div></div>"),je=z("<style></style>"),ke=z('<span class="filename-content"></span>'),o=[{name:"name",textAlign:"left",w:{"@initial":"calc(100% - 100px)","@md":"35%"}},{name:"size",textAlign:"right",w:{"@initial":"100px","@md":"30%"}},{name:"modified",textAlign:"right",w:{"@initial":0,"@md":"25%"}}],Se=()=>{const n=de,c=v(()=>n().reduce((h,l)=>h+(l.size||0),0)),i=_();return t(m,{get when(){return n().length>0},get children(){return t(b,{spacing:"$2",position:"fixed",top:"$4",right:"$4",transform:"none",get bgColor(){return K()},color:"white",p:"$2",rounded:"$lg",zIndex:"$banner",shadow:"$md",get children(){return[t(g,{get children(){return[f(()=>i("home.selected"))," ",f(()=>n().length)," ",f(()=>i("home.selected_count"))]}}),t(g,{get children(){return[f(()=>i("home.total_size"))," ",f(()=>H(c()))]}})]}})}})},ve=n=>{const{isHide:c}=V();if(O(),c(n.obj))return null;const{setPathAs:i}=O(),{show:h}=pe({id:1}),{pushHref:l,to:s,pathname:d}=J(),{openWithDoubleClick:r,toggleWithClick:u,restoreSelectionCache:y}=F(),R=_(),$=()=>le.list_item_filename_overflow,X=v(()=>xe(n.obj.storage_class)),P=v(()=>{const e=X();return e?R(`home.storage_class.${e}`):void 0}),G=()=>{const e=$();return e==="ellipsis"?{display:"inline-block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis",flex:"1 1 auto","min-width":0}:e==="scrollable"?{display:"inline-block","white-space":"nowrap",overflow:"hidden",flex:"1 1 auto","min-width":0}:{display:"block","white-space":"normal","word-break":"break-word","line-height":"1.4",flex:"1 1 auto","min-width":0}},W=()=>(se().permissions,ce(d(),n.obj.name));return[t(oe.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},style:{width:"100%"},get children(){return t(E,{get classList(){return{selected:!!n.obj.selected}},class:"list-item viselect-item",get"data-index"(){return n.index},w:"$full",p:"$2",rounded:"$lg",transition:"all 0.3s",spacing:"$1",alignItems:"stretch",get _hover(){return{transform:"scale(1.01)",backgroundColor:L()}},get bgColor(){return f(()=>!!n.obj.selected,!0)()?L():void 0},get children(){return[t(b,{w:"$full",spacing:"$2",get children(){return[t(b,{class:"name-box",spacing:"$1",get w(){return o[0].w},as:ye,get href(){return n.obj.name},get cursor(){return r()||u()?"default":"pointer"},"on:dblclick":()=>{r()&&(p(n.index,!0,!0),s(W()))},"on:click":e=>{if(e.preventDefault(),!r()&&!(e.ctrlKey||e.metaKey||e.shiftKey)&&y()){if(u())return p(n.index,!n.obj.selected);s(W())}},onMouseEnter:()=>{i(n.obj.name,n.obj.is_dir,!0)},onContextMenu:e=>{B(()=>{p(n.index,!0,!0)}),h(e,{props:n.obj})},get children(){return[t(m,{get when(){return D()},get children(){return t(U,{"on:mousedown":e=>{e.stopPropagation()},"on:click":e=>{e.stopPropagation()},get checked(){return n.obj.selected},onChange:e=>{p(n.index,e.target.checked)}})}}),t(Y,{class:"icon",boxSize:"$6",get color(){return K()},get as(){return Z(n.obj)},mr:"$1",get cursor(){return n.obj.type!==M.IMAGE?"inherit":"pointer"},"on:click":e=>{n.obj.type===M.IMAGE&&(e.ctrlKey||e.metaKey||e.shiftKey||y()&&(q.emit("gallery",n.obj.name),e.preventDefault(),e.stopPropagation()))}}),t(g,{class:"name",fontSize:{"@initial":"sm","@md":"md"},css:{position:"relative",flex:1,minWidth:0,cursor:"pointer",display:"flex","align-items":"center",gap:"0.5rem"},style:{"flex-wrap":"wrap"},get title(){return n.obj.name},get children(){return[(()=>{const e=ke.cloneNode(!0);return x(e,t(m,{get when(){return $()==="scrollable"},get children(){return[(()=>{const a=$e.cloneNode(!0);return(w=>{w&&Q(()=>{const j=()=>{const I=w.parentElement;I&&w.scrollWidth>I.clientWidth?w.classList.add("should-marquee"):w.classList.remove("should-marquee")};j(),window.addEventListener("resize",j),ee(()=>{window.removeEventListener("resize",j)})})})(a),a.style.setProperty("display","inline-block"),a.style.setProperty("white-space","nowrap"),a.style.setProperty("padding-right","50px"),x(a,()=>n.obj.name),a})(),(()=>{const a=je.cloneNode(!0);return x(a,()=>`
                      .should-marquee:hover {
                        animation: marquee 8s linear infinite;
                      }
                      @keyframes marquee {
                        0% { transform: translateX(0); }
                        100% { transform: translateX(calc(-100% + ${o[0].w["@initial"]})); }
                      }
                      `),a})()]}}),null),x(e,t(m,{get when(){return $()!=="scrollable"},get children(){return n.obj.name}}),null),te(a=>ne(e,G(),a)),e})(),t(m,{get when(){return P()},get children(){return t(k,{variant:"subtle",colorScheme:"primary",textTransform:"none",css:{"flex-shrink":0,"font-size":"0.65rem"},get children(){return P()}})}})]}})]}}),t(b,{spacing:"$0_5",justifyContent:"flex-start",overflow:"hidden",w:"25%",minW:"200px",display:{"@initial":"none","@md":"flex"},get children(){return t(m,{get when(){var e;return(e=n.obj.label_list)==null?void 0:e.length},get children(){return t(C,{get each(){return n.obj.label_list||[]},children:e=>t(re,{get label(){return e.name},placement:"top",get children(){return t(k,{colorScheme:"primary",get bgColor(){return T(e.bg_color)},get color(){return e.bg_color},variant:"solid",mr:"$0_5",textTransform:"none",maxW:"120px",overflow:"hidden",css:{textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.75rem",paddingInline:"0.5rem",paddingBlock:"0.25rem"},get children(){return e.name}})}})})}})}}),t(ie,{w:{"@initial":"90px","@md":"12%"},minW:{"@initial":"90px","@md":"12%"},display:"flex",justifyContent:{"@initial":"flex-end","@md":"flex-start"},flexShrink:0,pr:{"@initial":"0","@md":"$2"},get children(){return t(g,{class:"size",fontSize:{"@initial":"sm","@md":"md"},css:{whiteSpace:"nowrap"},get children(){return H(n.obj.size)}})}}),t(g,{class:"modified",display:{"@initial":"none","@md":"inline"},w:"20%",minW:"20%",textAlign:"right",css:{whiteSpace:"nowrap"},get children(){return ae(n.obj.modified)}})]}}),t(m,{get when(){var e;return(e=n.obj.label_list)==null?void 0:e.length},get children(){return t(b,{spacing:"$1",flexWrap:"wrap",pl:"$8",display:{"@initial":"flex","@md":"none"},w:"$full",get children(){return t(C,{get each(){return n.obj.label_list||[]},children:e=>t(k,{colorScheme:"primary",get bgColor(){return T(e.bg_color)},get color(){return e.bg_color},variant:"solid",textTransform:"none",css:{fontSize:"0.65rem",paddingInline:"0.3rem",paddingBlock:"0.1rem",whiteSpace:"nowrap",lineHeight:"1.2"},get children(){return e.name}})})}})}})]}})}}),t(Se,{})]},N=n=>{const c=_(),[i,h]=A(),[l,s]=A(!1);ue(()=>{i()&&n.sortCallback(i(),l())});const d=r=>({fontWeight:"bold",fontSize:"$sm",color:"$neutral11",textAlign:r.textAlign,cursor:"pointer",onClick:()=>{r.name===i()?s(!l()):B(()=>{h(r.name),s(!1)})}});return t(b,{class:"title",w:"$full",p:"$2",get children(){return[t(b,{get w(){return o[0].w},spacing:"$1",get children(){return[t(m,{get when(){return f(()=>!n.disableCheckbox,!0)()&&D()},get children(){return t(U,{get checked(){return ge()},get indeterminate(){return he()},onChange:r=>{fe(r.target.checked)}})}}),t(g,S(()=>d(o[0]),{get children(){return c(`home.obj.${o[0].name}`)}}))]}}),t(g,S({get w(){return o[1].w}},()=>d(o[1]),{get children(){return c(`home.obj.${o[1].name}`)}})),t(g,S({get w(){return o[2].w}},()=>d(o[2]),{display:{"@initial":"none","@md":"inline"},get children(){return c(`home.obj.${o[2].name}`)}}))]}})},Ce=()=>{const n=l=>{var r;const s=UserPermissions.findIndex(u=>u==="write");if(!UserMethods.can(me(),s,getCurrentPath()))return;const d=Array.from(((r=l.dataTransfer)==null?void 0:r.items)??[]);for(let u=0;u<d.length;u++)if(d[u].kind==="file"){q.emit("tool","upload"),l.preventDefault();break}},{isMouseSupported:c,registerSelectContainer:i,captureContentMenu:h}=F();return i(),t(E,{onDragOver:n,"oncapture:contextmenu":h,class:"list viselect-container",w:"$full",spacing:"$1",get children(){return[t(N,{sortCallback:be}),t(C,{get each(){return we.objs},children:(l,s)=>t(ve,{obj:l,get index(){return s()}})})]}})},Le=Object.freeze(Object.defineProperty({__proto__:null,ListTitle:N,default:Ce},Symbol.toStringTag,{value:"Module"}));export{N as L,Le as a,o as c};
